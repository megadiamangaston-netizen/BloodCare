"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[174],{8581:function(e,t,r){r.d(t,{Z:function(){return c}});var a=r(7437),o=r(5403),n=r(4033),s=r(2265),i=r(5251),l=r(9036);function c(e){let{children:t,requiredRole:r,fallbackPath:c="/"}=e;const{user:d,loading:u}=(0,o.a)(),m=(0,n.useRouter)();if((0,s.useEffect)((()=>{u||d||m.push(c)}),[d,u,m,c]),u)return(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,a.jsx)(i.E.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-16 h-16 border-4 border-primary-600 border-t-transparent rounded-full"})});if(!d)return null;return(Array.isArray(r)?r.includes(d.role):d.role===r)?(0,a.jsx)(a.Fragment,{children:t}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:(0,a.jsxs)(i.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-2xl p-8 shadow-xl max-w-md w-full text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(l.Z,{className:"text-red-600",size:32})}),(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Acc\xe8s restreint"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Vous n'avez pas les permissions n\xe9cessaires pour acc\xe9der \xe0 cette page."}),(0,a.jsx)("button",{onClick:()=>m.push("/"),className:"bg-primary-600 hover:bg-primary-700 text-white px-6 py-2 rounded-lg transition-colors",children:"Retour \xe0 l'accueil"})]})})}},6806:function(e,t,r){var a=r(7437),o=r(2265),n=r(5251);const s=(0,o.forwardRef)(((e,t)=>{let{variant:r="primary",size:o="md",loading:s=!1,children:i,className:l="",...c}=e;return(0,a.jsxs)(n.E.button,{ref:t,whileHover:{scale:1.02},whileTap:{scale:.98},className:"".concat("inline-flex items-center justify-center font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"bg-primary-600 hover:bg-primary-700 text-white focus:ring-primary-500",secondary:"bg-secondary-600 hover:bg-secondary-700 text-white focus:ring-secondary-500",outline:"border-2 border-primary-600 text-primary-600 hover:bg-primary-600 hover:text-white focus:ring-primary-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500",destructive:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500"}[r]," ").concat({sm:"px-3 py-2 text-sm",md:"px-4 py-2.5 text-base",lg:"px-6 py-3 text-lg"}[o]," ").concat(l),disabled:s||c.disabled,...c,children:[s&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i]})}));s.displayName="Button",t.Z=s},9310:function(e,t,r){var a=r(7437);const o=(0,r(2265).forwardRef)(((e,t)=>{let{label:r,error:o,icon:n,className:s="",...i}=e;return(0,a.jsxs)("div",{className:"w-full",children:[r&&(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r}),(0,a.jsxs)("div",{className:"relative",children:[n&&(0,a.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:n}),(0,a.jsx)("input",{ref:t,className:"\n              w-full px-3 py-3 border border-gray-300 rounded-lg \n              focus:ring-2 focus:ring-primary-500 focus:border-transparent\n              placeholder-gray-400 transition-all duration-200\n              ".concat(n?"pl-10":"","\n              ").concat(o?"border-red-500 ring-2 ring-red-200":"","\n              ").concat(s,"\n            "),...i})]}),o&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:o})]})}));o.displayName="Input",t.Z=o},1639:function(e,t,r){r.d(t,{Z:function(){return d}});var a=r(7437),o=r(2265),n=r(6142),s=r(519),i=r(6654),l=r(6806),c=r(8832);function d(e){let{latitude:t,longitude:r,onLocationSelect:d,campaigns:u=[],showCampaigns:m=!1,className:g=""}=e;const p=(0,o.useRef)(null),[h,f]=(0,o.useState)(null),[x,w]=(0,o.useState)(null),[y,v]=(0,o.useState)([]),[b,j]=(0,o.useState)(!0),[N,E]=(0,o.useState)(null),[A,C]=(0,o.useState)(!1);(0,o.useEffect)((()=>{(0,c.$I)().then((()=>{(()=>{if(p.current)try{const e=t&&r?{lat:t,lng:r}:{lat:3.8667,lng:11.5167},a=new window.google.maps.Map(p.current,{center:e,zoom:13,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1,zoomControl:!0,scaleControl:!0});let o=null;m||(o=new window.google.maps.Marker({position:e,map:a,draggable:!0,title:"Position de la campagne"}),o.addListener("dragend",(()=>{const e=o.getPosition();e&&d(e.lat(),e.lng())}))),m||a.addListener("click",(e=>{if(e.latLng){const t=e.latLng.lat(),r=e.latLng.lng();o.setPosition({lat:t,lng:r}),d(t,r)}})),f(a),w(o),j(!1),m&&u.length>0&&I(a,u)}catch(N){console.error("Erreur initialisation carte:",N),E("Erreur d'initialisation de la carte: ".concat(N instanceof Error?N.message:"Erreur inconnue")),j(!1)}})()})).catch((e=>{console.error("Erreur chargement Google Maps:",e),E(e.message||"Erreur lors du chargement de Google Maps"),j(!1)}))}),[]);const I=(e,t)=>{y.forEach((e=>e.setMap(null)));const r=[];if(t.forEach(((t,a)=>{var o,n;if(!(null===(o=t.location)||void 0===o?void 0:o.latitude)||!(null===(n=t.location)||void 0===n?void 0:n.longitude))return void console.warn("Campagne ".concat(t.id," sans coordonn\xe9es valides"));const s={lat:t.location.latitude,lng:t.location.longitude};let i="#FF6B6B";"active"===t.status?i="#4ECB71":"upcoming"===t.status?i="#45B7D1":"completed"===t.status&&(i="#96A3B4");const l=new window.google.maps.Marker({position:s,map:e,title:t.title,icon:{path:"M12,2C8.13,2 5,5.13 5,9C5,14.25 12,22 12,22C12,22 19,14.25 19,9C19,5.13 15.87,2 12,2M12,7A2,2 0 0,1 14,9A2,2 0 0,1 12,11A2,2 0 0,1 10,9A2,2 0 0,1 12,7Z",fillColor:i,fillOpacity:.9,strokeColor:"#FFFFFF",strokeWeight:2,scale:2.2,anchor:{x:12,y:22}}}),c=new window.google.maps.InfoWindow({content:'\n          <div class="p-3 max-w-sm">\n            <h3 class="font-bold text-lg text-gray-800 mb-2">'.concat(t.title,'</h3>\n            <p class="text-sm text-gray-600 mb-2">').concat(t.description,'</p>\n            <div class="space-y-1 text-sm">\n              <p><strong>\ud83c\udfe5 H\xf4pital:</strong> ').concat(t.hospitalName,"</p>\n              <p><strong>\ud83d\udccd Adresse:</strong> ").concat(t.location.address,"</p>\n              <p><strong>\ud83e\ude78 Groupes recherch\xe9s:</strong> ").concat(t.targetBloodTypes.join(", "),'</p>\n              <p><strong>\ud83d\udcca Statut:</strong> <span class="px-2 py-1 rounded text-xs font-medium \n                ').concat("active"===t.status?"bg-green-100 text-green-800":"upcoming"===t.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800",'">\n                ').concat("active"===t.status?"\ud83d\udfe2 Active":"upcoming"===t.status?"\ud83d\udd35 \xc0 venir":"\u26ab Termin\xe9e","\n              </span></p>\n            </div>\n          </div>\n        ")});l.addListener("click",(()=>{r.forEach((e=>{e.infoWindow&&e.infoWindow.close()})),c.open(e,l)})),l.infoWindow=c,r.push(l)})),v(r),console.log("\u2705 ".concat(r.length," marqueurs de campagnes cr\xe9\xe9s")),r.length>0){const a=new window.google.maps.LatLngBounds;t.forEach((e=>{var t,r;(null===(t=e.location)||void 0===t?void 0:t.latitude)&&(null===(r=e.location)||void 0===r?void 0:r.longitude)&&a.extend({lat:e.location.latitude,lng:e.location.longitude})})),e.fitBounds(a),1===r.length&&e.setZoom(Math.min(e.getZoom(),14)),console.log("\ud83d\udccd Vue ajust\xe9e pour inclure toutes les campagnes")}};(0,o.useEffect)((()=>{h&&m&&u.length>0&&I(h,u)}),[u,h,m]),(0,o.useEffect)((()=>{if(h&&x&&t&&r){const e={lat:t,lng:r};x.setPosition(e),h.setCenter(e)}}),[t,r,h,x]);return N?(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 ".concat(g),children:(0,a.jsxs)("div",{className:"flex items-center text-red-600",children:[(0,a.jsx)(n.Z,{className:"mr-2",size:20}),(0,a.jsx)("span",{className:"text-sm",children:N})]})}):(0,a.jsx)("div",{className:g,children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(l.Z,{type:"button",variant:"outline",onClick:()=>{if(C(!0),!navigator.geolocation)return E("G\xe9olocalisation non support\xe9e"),void C(!1);navigator.geolocation.getCurrentPosition((e=>{const t=e.coords.latitude,r=e.coords.longitude;if(h&&x){const e={lat:t,lng:r};x.setPosition(e),h.setCenter(e),h.setZoom(15)}d(t,r),C(!1)}),(e=>{console.error("Erreur g\xe9olocalisation:",e),E("Impossible d'obtenir votre position"),C(!1)}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},disabled:A||b,className:"flex-1",children:[A?(0,a.jsx)(s.Z,{className:"animate-spin mr-2",size:16}):(0,a.jsx)(i.Z,{className:"mr-2",size:16}),"Ma position actuelle"]}),(0,a.jsxs)(l.Z,{type:"button",variant:"outline",disabled:b,onClick:()=>{h&&(h.setCenter({lat:3.8667,lng:11.5167}),h.setZoom(13))},children:[(0,a.jsx)(n.Z,{className:"mr-2",size:16}),"Recentrer Yaound\xe9"]})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{ref:p,className:"w-full h-96 rounded-lg border border-gray-300",style:{minHeight:"384px"}}),b&&(0,a.jsx)("div",{className:"absolute inset-0 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(s.Z,{className:"animate-spin mx-auto mb-2 text-gray-400",size:24}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Chargement de la carte..."})]})})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 space-y-1",children:[(0,a.jsx)("p",{children:"\u2022 Cliquez sur la carte pour placer le marqueur"}),(0,a.jsx)("p",{children:"\u2022 Glissez le marqueur pour ajuster la position"}),0!==t&&0!==r&&(0,a.jsxs)("p",{className:"text-green-600 font-medium",children:["Position s\xe9lectionn\xe9e: ",t.toFixed(6),", ",r.toFixed(6)]})]})]})})}},5403:function(e,t,r){r.d(t,{H:function(){return d},a:function(){return u}});var a=r(7437),o=r(2265),n=r(7007),s=r(4086),i=r(6831),l=r(5925);const c=(0,o.createContext)(void 0);function d(e){let{children:t}=e;const[r,d]=(0,o.useState)(null),[u,m]=(0,o.useState)(null),[g,p]=(0,o.useState)(!0);(0,o.useEffect)((()=>{const e=(0,n.Aj)(i.I8,(async e=>{if(m(e),e)try{const a=await(0,s.QT)((0,s.JU)(i.db,"users",e.uid));if(a.exists()){var t,r;const o=a.data();d({id:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:o.role||"user",hospitalId:o.hospitalId,createdAt:(null===(t=o.createdAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(r=o.updatedAt)||void 0===r?void 0:r.toDate())||new Date})}else{const t={id:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:"user",createdAt:new Date,updatedAt:new Date};await(0,s.pl)((0,s.JU)(i.db,"users",e.uid),{...t,createdAt:new Date,updatedAt:new Date}),d(t)}}catch(o){var a;if(console.error("Error fetching user data:",o),"unavailable"===o.code||(null===(a=o.message)||void 0===a?void 0:a.includes("offline"))){console.warn("Firestore hors ligne - cr\xe9ation d'un utilisateur local temporaire");const t={id:e.uid,email:e.email,displayName:e.displayName||"Utilisateur",photoURL:e.photoURL,role:"user",createdAt:new Date,updatedAt:new Date};d(t),l.default.success("Mode hors ligne activ\xe9")}else l.default.error("Erreur lors du chargement des donn\xe9es utilisateur")}else d(null);p(!1)}));return()=>e()}),[]);const h={user:r,firebaseUser:u,loading:g,signInWithEmail:async(e,t)=>{try{await(0,n.e5)(i.I8,e,t),l.default.success("Connexion r\xe9ussie !")}catch(r){throw console.error("Error signing in:",r),l.default.error("Erreur de connexion : "+r.message),r}},signInWithGoogle:async()=>{try{await(0,n.rh)(i.I8,i.Vv),l.default.success("Connexion Google r\xe9ussie !")}catch(e){throw console.error("Error signing in with Google:",e),l.default.error("Erreur de connexion Google : "+e.message),e}},signUpWithEmail:async(e,t,r)=>{try{const{user:a}=await(0,n.Xb)(i.I8,e,t);await(0,n.ck)(a,{displayName:r});const o={id:a.uid,email:a.email,displayName:r,role:"user",createdAt:new Date,updatedAt:new Date};await(0,s.pl)((0,s.JU)(i.db,"users",a.uid),{...o,createdAt:new Date,updatedAt:new Date}),l.default.success("Compte cr\xe9\xe9 avec succ\xe8s !")}catch(a){throw console.error("Error signing up:",a),l.default.error("Erreur lors de la cr\xe9ation du compte : "+a.message),a}},logout:async()=>{try{await(0,n.w7)(i.I8),l.default.success("D\xe9connexion r\xe9ussie")}catch(e){console.error("Error signing out:",e),l.default.error("Erreur lors de la d\xe9connexion")}},updateUserRole:async(e,t)=>{try{await(0,s.r7)((0,s.JU)(i.db,"users",e),{role:t,updatedAt:new Date}),l.default.success("R\xf4le utilisateur mis \xe0 jour")}catch(r){throw console.error("Error updating user role:",r),l.default.error("Erreur lors de la mise \xe0 jour du r\xf4le"),r}},createFirstSuperAdmin:async e=>{try{const t=(await(0,s.PL)((0,s.hJ)(i.db,"users"))).docs.find((t=>t.data().email===e));t?(await(0,s.r7)((0,s.JU)(i.db,"users",t.id),{role:"super_admin",updatedAt:new Date}),l.default.success("Super admin cr\xe9\xe9 avec succ\xe8s"),window.location.reload()):l.default.error("Utilisateur non trouv\xe9")}catch(t){console.error("Error creating super admin:",t),l.default.error("Erreur lors de la cr\xe9ation du super admin")}}};return(0,a.jsx)(c.Provider,{value:h,children:t})}function u(){const e=(0,o.useContext)(c);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}},6831:function(e,t,r){r.d(t,{I8:function(){return l},Vv:function(){return c},db:function(){return d}});var a=r(994),o=r(7007),n=r(4086),s=r(9584);const i=(0,a.ZF)({apiKey:"AIzaSyBLpLQIqKcWgUVYDttXit1x5nRrcFB1RmM",authDomain:"hemoconnect-ec751.firebaseapp.com",projectId:"hemoconnect-ec751",storageBucket:"hemoconnect-ec751.firebasestorage.app",messagingSenderId:"324649213432",appId:"1:324649213432:web:77683bec35f3fe9b4a8a0d"}),l=(0,o.v0)(i),c=new o.hJ;c.setCustomParameters({prompt:"select_account"});const d=(0,n.ad)(i);(0,s.cF)(i)},8832:function(e,t,r){r.d(t,{$I:function(){return s}});let a=!1,o=!1,n=null;const s=()=>a&&window.google&&window.google.maps?Promise.resolve():(o&&n||(n=new Promise(((e,t)=>{if(window.google&&window.google.maps&&window.google.maps.places)return a=!0,void e();o=!0;const r="AIzaSyD_7kY3J-gOmf7D5yK-SwlFap0TrhDp15s";document.querySelectorAll('script[src*="maps.googleapis.com"]').forEach((e=>e.remove())),window.initGoogleMaps&&delete window.initGoogleMaps;const n="initGoogleMapsAPI";window[n]=()=>{a=!0,o=!1,delete window[n],e()};const s=document.createElement("script");s.src="https://maps.googleapis.com/maps/api/js?key=".concat(r,"&libraries=places&region=CM&language=fr&callback=").concat(n),s.async=!0,s.defer=!0,s.onerror=()=>{o=!1,delete window[n],t(new Error("Erreur lors du chargement de l'API Google Maps"))},document.head.appendChild(s),setTimeout((()=>{o&&(o=!1,delete window[n],t(new Error("Timeout lors du chargement de l'API Google Maps")))}),1e4)}))),n)}}]);