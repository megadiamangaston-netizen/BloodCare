(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{8858:function(e,t,s){Promise.resolve().then(s.bind(s,7924))},8420:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(9763).Z)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},1047:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(9763).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},6927:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(9763).Z)("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]])},6540:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(9763).Z)("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]])},3774:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(9763).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},2718:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(9763).Z)("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]])},9397:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(9763).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},8906:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(9763).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},8896:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(9763).Z)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},8930:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(9763).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},5805:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(9763).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},2489:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},9376:function(e,t,s){"use strict";var a=s(5475);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}})},7924:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return R}});var a=s(7437),l=s(2265),r=s(8239),n=s(6927),i=s(1047),o=s(5805),c=s(9763);const d=(0,c.Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);var m=s(8420);const u=(0,c.Z)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var x=s(9397),p=s(8930),h=s(3774);const g=(0,c.Z)("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);var v=s(2718);const y=(0,c.Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),b=(0,c.Z)("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),f=(0,c.Z)("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),j=(0,c.Z)("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);var N=s(2489),w=s(5978),k=s(6410),D=s(4603),E=s(3002),S=s(6334),C=s(2827);const Z={critical:"#DC2626",low:"#F59E0B",normal:"#10B981",high:"#059669"};function A(e){let{bloodType:t,count:s,maxCount:n=20,level:i}=e;const[o,c]=(0,l.useState)(0),d=Math.min(s/n*100,100),m=Z[i];return(0,l.useEffect)((()=>{const e=setTimeout((()=>{c(s)}),200);return()=>clearTimeout(e)}),[s]),(0,a.jsxs)("div",{className:"relative bg-white rounded-2xl border-2 border-gray-200 p-4 overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-gray-50 to-gray-100 opacity-50"}),(0,a.jsxs)("div",{className:"relative h-36 mb-4 bg-gray-100 rounded-xl border-2 border-gray-200 overflow-hidden",children:[(0,a.jsxs)(r.E.div,{className:"absolute bottom-0 left-0 right-0 overflow-hidden",style:{backgroundColor:m,boxShadow:"0 0 20px ".concat(m,"40"),borderRadius:"0 0 12px 12px"},initial:{height:"0%"},animate:{height:"".concat(d,"%")},transition:{duration:1.5,ease:"easeOut",delay:.2},children:[(0,a.jsx)(r.E.div,{className:"absolute inset-0",style:{background:"linear-gradient(180deg, ".concat(m,"CC 0%, ").concat(m," 100%)")},animate:{borderRadius:["0 0 12px 12px","0 0 8px 16px","0 0 16px 8px","0 0 12px 12px"]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:(0,a.jsx)(r.E.div,{className:"absolute top-0 left-0 right-0 h-4",style:{background:"radial-gradient(ellipse at center, rgba(255,255,255,0.3) 0%, transparent 70%)"},animate:{transform:["translateY(0px) scaleY(1)","translateY(-2px) scaleY(0.8)","translateY(2px) scaleY(1.2)","translateY(0px) scaleY(1)"]},transition:{duration:2.5,repeat:1/0,ease:"easeInOut"}})}),(0,a.jsx)(r.E.div,{className:"absolute inset-0 opacity-40",style:{background:"linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.4) 50%, transparent 70%)"},animate:{x:["-100%","200%"]},transition:{duration:2.8,repeat:1/0,ease:"easeInOut"}}),(0,a.jsx)(r.E.div,{className:"absolute top-0 left-0 right-0 h-2",style:{background:"linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.6) 50%, transparent 100%)"},animate:{x:["-100%","100%"]},transition:{duration:2,repeat:1/0,ease:"easeInOut",delay:.5}}),[...Array(3)].map(((e,t)=>(0,a.jsx)(r.E.div,{className:"absolute w-1 h-1 bg-white rounded-full opacity-60",style:{left:"".concat(20+25*t,"%"),bottom:"".concat(10+15*t,"%")},animate:{y:[0,-20,0],scale:[.5,1,.5],opacity:[.6,.9,.6]},transition:{duration:1.5+.3*t,repeat:1/0,ease:"easeInOut",delay:.5*t}},t))),(0,a.jsx)(r.E.div,{className:"absolute inset-0 opacity-20",style:{background:"linear-gradient(135deg, ".concat(m," 0%, transparent 50%, ").concat(m," 100%)")},animate:{skewX:[-2,2,-2],scaleX:[1,1.02,1]},transition:{duration:2.2,repeat:1/0,ease:"easeInOut"}})]}),(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-10",children:[(0,a.jsx)(r.E.div,{className:"text-2xl font-bold mb-1 drop-shadow-lg ".concat("critical"===i?"text-red-500":"low"===i?"text-yellow-500":"normal"===i?"text-green-500":"text-green-600"),initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.5},children:t}),(0,a.jsx)(r.E.div,{className:"text-3xl font-bold drop-shadow-lg mb-1 ".concat("critical"===i?"text-red-500":"low"===i?"text-yellow-500":"normal"===i?"text-green-500":"text-green-600"),initial:{scale:1.2,opacity:.7},animate:{scale:1,opacity:1},transition:{duration:.3},children:o},o),(0,a.jsx)("div",{className:"text-xs font-medium uppercase tracking-wide drop-shadow ".concat("critical"===i?"text-red-500":"low"===i?"text-yellow-500":"normal"===i?"text-green-500":"text-green-600"),children:"critical"===i?"Critique":"low"===i?"Faible":"normal"===i?"Normal":"\xc9lev\xe9"})]}),s>0&&(0,a.jsx)(r.E.div,{className:"absolute top-2 left-1/2 w-2 h-2 rounded-full",style:{backgroundColor:m},initial:{y:-20,x:-4,scale:.5,opacity:.8},animate:{y:20,scale:[.5,1,.5],opacity:[.8,1,0]},transition:{duration:.8,ease:"easeIn"}},s)]}),(0,a.jsx)("div",{className:"text-center mt-2",children:(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[d.toFixed(0),"% de capacit\xe9"]})}),"critical"===i&&(0,a.jsx)(r.E.div,{className:"absolute inset-0 border-2 border-red-500 rounded-2xl",animate:{opacity:[0,.3,0],scale:[1,1.02,1]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})]})}var T=e=>{let{data:t}=e;const s=t.reduce(((e,t)=>e+t.count),0);if(0===s)return(0,a.jsx)("div",{className:"flex items-center justify-center h-64 text-gray-500",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full border-4 border-gray-200 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-gray-400",children:"0%"})}),(0,a.jsx)("p",{children:"Aucune poche en stock"})]})});let l=0;const n=80,i=120,o=120,c=(e,t,s,a)=>{const l=(a-90)*Math.PI/180;return{x:e+s*Math.cos(l),y:t+s*Math.sin(l)}};return(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 border",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-6 text-center",children:"R\xe9partition par Groupe Sanguin"}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row items-center gap-8",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("svg",{width:"240",height:"240",className:"transform -rotate-90",children:t.map(((e,t)=>{if(0===e.count)return null;const d=e.count/s*360,m=((e,t)=>{const s=c(i,o,n,t),a=c(i,o,n,e),l=t-e<=180?"0":"1";return["M",i,o,"L",s.x,s.y,"A",n,n,0,l,0,a.x,a.y,"Z"].join(" ")})(l,l+d),u=(0,a.jsx)(r.E.path,{d:m,fill:e.color,stroke:"white",strokeWidth:"2",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:.1*t,duration:.6,ease:"easeOut"},className:"hover:opacity-80 transition-opacity cursor-pointer",style:{filter:"drop-shadow(0 2px 4px rgba(0,0,0,0.1))"}},e.bloodType);return l+=d,u}))}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-white rounded-full w-24 h-24 border-4 border-gray-100 flex flex-col items-center justify-center shadow-lg",children:[(0,a.jsx)("span",{className:"text-2xl font-bold text-gray-800",children:s}),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Total"})]})})]}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:t.map(((e,t)=>(0,a.jsxs)(r.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.1*t+.3},className:"flex items-center space-x-3 p-3 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-semibold text-gray-900",children:e.bloodType}),(0,a.jsxs)("span",{className:"text-sm text-gray-600",children:[e.percentage.toFixed(1),"%"]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[e.count," poche",e.count>1?"s":""]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5 mt-1",children:(0,a.jsx)(r.E.div,{className:"h-1.5 rounded-full",style:{backgroundColor:e.color},initial:{width:0},animate:{width:"".concat(e.percentage,"%")},transition:{delay:.1*t+.5,duration:.8}})})]})]},e.bloodType)))})})]})]})},z=s(2190);const I=(0,c.Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var P=s(8237);function q(e){let{label:t,placeholder:s="Tapez une adresse...",value:r,onChange:n,required:i=!1,className:o=""}=e;const[c,d]=(0,l.useState)([]),[m,u]=(0,l.useState)(!1),[x,p]=(0,l.useState)(!1),[g,v]=(0,l.useState)(null),[y,b]=(0,l.useState)(null),f=(0,l.useRef)(null),j=(0,l.useRef)(null);(0,l.useEffect)((()=>{(0,P.$I)().then((()=>{(()=>{try{console.log("Initialisation des services Google Places...");const e=new window.google.maps.places.AutocompleteService,t=new window.google.maps.places.PlacesService(document.createElement("div"));v(e),b(t),console.log("Services Google Places initialis\xe9s avec succ\xe8s")}catch(e){console.error("Erreur lors de l'initialisation des services Places:",e)}})()})).catch((e=>{console.error("Erreur chargement API Google Maps pour AddressInput:",e)}))}),[]),(0,l.useEffect)((()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&f.current&&!f.current.contains(e.target)&&u(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]);return(0,a.jsxs)("div",{className:"relative ".concat(o),children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[t,i&&(0,a.jsx)("span",{className:"text-red-500 ml-1",children:"*"})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{ref:f,type:"text",value:r,onChange:e=>{const t=e.target.value;n(t),(e=>{if(console.log("searchPlaces appel\xe9 avec:",e),!g)return void console.log("Service d'autocompl\xe9tion non disponible");if(e.length<2)return d([]),void u(!1);p(!0);const t={input:e,componentRestrictions:{country:"cm"},types:["establishment","geocode"]};console.log("Requ\xeate de recherche:",t),g.getPlacePredictions(t,((t,s)=>{if(console.log("R\xe9ponse API Places:",{status:s,predictions:t}),p(!1),s===window.google.maps.places.PlacesServiceStatus.OK&&t&&t.length>0)console.log("Pr\xe9dictions re\xe7ues:",t.length),d(t.slice(0,5)),u(!0);else if(console.log("Aucune pr\xe9diction ou erreur:",s),d([]),u(!1),0===(null===t||void 0===t?void 0:t.length)){console.log("Tentative sans restriction de pays...");const t={input:e,types:["establishment","geocode"]};g.getPlacePredictions(t,((e,t)=>{console.log("R\xe9ponse fallback:",{fallbackStatus:t,fallbackPredictions:e}),t===window.google.maps.places.PlacesServiceStatus.OK&&e&&(d(e.slice(0,5)),u(!0))}))}}))})(t)},onFocus:()=>{c.length>0&&u(!0)},placeholder:s,required:i,className:"w-full px-3 py-3 pl-10 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition-colors"}),(0,a.jsx)(h.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),m&&(0,a.jsx)(I,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18})]}),m&&(c.length>0||x)&&(0,a.jsx)("div",{ref:j,className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:x?(0,a.jsxs)("div",{className:"px-4 py-3 text-sm text-gray-500 flex items-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-red-500 mr-2"}),"Recherche d'adresses..."]}):c.map((e=>(0,a.jsx)("button",{type:"button",onClick:()=>(e=>{if(!y)return;const t={placeId:e.place_id,fields:["geometry","formatted_address"]};y.getDetails(t,((t,s)=>{if(s===window.google.maps.places.PlacesServiceStatus.OK&&t){const e={lat:t.geometry.location.lat(),lng:t.geometry.location.lng()};n(t.formatted_address,e)}else n(e.description)})),u(!1),d([])})(e),className:"w-full px-4 py-3 text-left hover:bg-gray-50 focus:bg-gray-50 focus:outline-none border-b border-gray-100 last:border-b-0",children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)(h.Z,{className:"text-red-500 mr-3 mt-1 flex-shrink-0",size:16}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.structured_formatting.main_text}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:e.structured_formatting.secondary_text})]})]})},e.place_id)))})]}),!g&&(0,a.jsxs)("div",{className:"flex items-center mt-2 text-xs text-amber-600 bg-amber-50 px-3 py-2 rounded border border-amber-200",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-amber-600 mr-2"}),"Service d'autocompl\xe9tion en cours de chargement..."]}),g&&(0,a.jsx)("p",{className:"text-xs text-green-600 mt-1",children:"\u2705 Autocompl\xe9tion activ\xe9e - Tapez pour voir les suggestions"})]})}var M=s(9064);function R(){const{user:e,logout:t}=(0,D.a)(),[c,Z]=(0,l.useState)("stock"),[I,P]=(0,l.useState)([]),[R,O]=(0,l.useState)([]),[B,L]=(0,l.useState)([]),[F,_]=(0,l.useState)([]),[V,H]=(0,l.useState)(!0),[J,X]=(0,l.useState)(!1),[U,Y]=(0,l.useState)(!1),[G,K]=(0,l.useState)(!1),[W,Q]=(0,l.useState)(!1),[$,ee]=(0,l.useState)(!1),[te,se]=(0,l.useState)(null),[ae,le]=(0,l.useState)(null),[re,ne]=(0,l.useState)({}),[ie,oe]=(0,l.useState)(!1),[ce,de]=(0,l.useState)({name:(null===e||void 0===e?void 0:e.displayName)||"",phone:"",address:""}),[me,ue]=(0,l.useState)({bloodType:"O+",volume:450,collectionDate:(new Date).toISOString().split("T")[0],expiryDate:new Date(Date.now()+36288e5).toISOString().split("T")[0],ville:""}),[xe,pe]=(0,l.useState)({title:"",description:"",address:"",latitude:0,longitude:0,targetBloodTypes:[],startDate:"",endDate:"",maxDonors:50}),[he,ge]=(0,l.useState)({appointmentDate:(new Date).toISOString().split("T")[0],appointmentTime:"09:00",duration:30,notes:"",location:{address:"",room:"",floor:"",coordinates:null}});(0,l.useEffect)((()=>{(null===e||void 0===e?void 0:e.id)&&(be(),fe(),je(),ye(),ve())}),[e]);const ve=async()=>{try{console.log("\ud83d\udd04 Chargement du profil admin pour userId:",null===e||void 0===e?void 0:e.id);(0,w.JU)(k.db,"adminProfiles",(null===e||void 0===e?void 0:e.id)||"");const t=await(0,w.PL)((0,w.IO)((0,w.hJ)(k.db,"adminProfiles"),(0,w.ar)("userId","==",null===e||void 0===e?void 0:e.id)));if(t.empty)console.log("\ud83d\udccb Aucun profil trouv\xe9, utilisation des donn\xe9es par d\xe9faut"),de({name:(null===e||void 0===e?void 0:e.displayName)||"",phone:"",address:""});else{const s=t.docs[0].data();console.log("\ud83d\udccb Profil trouv\xe9:",s),de({name:s.name||(null===e||void 0===e?void 0:e.displayName)||"",phone:s.phone||"",address:s.address||""})}}catch(t){console.error("\u274c Erreur lors du chargement du profil:",t)}},ye=async()=>{try{console.log("\ud83d\udd04 Chargement des rendez-vous pour hospitalId:",null===e||void 0===e?void 0:e.id);const t=(0,w.IO)((0,w.hJ)(k.db,"appointments"),(0,w.ar)("hospitalId","==",null===e||void 0===e?void 0:e.id)),s=await(0,w.PL)(t);console.log("\ud83d\udccb Nombre de rendez-vous trouv\xe9s:",s.docs.length);const a=s.docs.map((e=>{const t=e.data();return console.log("\ud83d\udcc5 Donn\xe9es rendez-vous:",t),{id:e.id,...t,appointmentDate:t.appointmentDate.toDate(),createdAt:t.createdAt.toDate()}}));a.sort(((e,t)=>t.appointmentDate.getTime()-e.appointmentDate.getTime())),_(a),console.log("\u2705 Rendez-vous charg\xe9s avec succ\xe8s")}catch(t){console.error("\u274c Erreur d\xe9taill\xe9e lors du chargement des rendez-vous:",t),t instanceof Error&&(console.error("Message d'erreur:",t.message),console.error("Code d'erreur:",t.code)),M.Am.error("Erreur de chargement: ".concat(t instanceof Error?t.message:"Erreur inconnue"))}},be=async()=>{try{const t=(0,w.IO)((0,w.hJ)(k.db,"poche"),(0,w.ar)("hospitalId","==",null===e||void 0===e?void 0:e.id)),s=(await(0,w.PL)(t)).docs.map((e=>{var t,s;return{id:e.id,...e.data(),collectionDate:(null===(t=e.data().collectionDate)||void 0===t?void 0:t.toDate())||new Date,expiryDate:(null===(s=e.data().expiryDate)||void 0===s?void 0:s.toDate())||new Date}}));P(s),console.log("Stock charg\xe9:",s.length,"poches pour utilisateur:",null===e||void 0===e?void 0:e.id)}catch(t){console.error("Erreur chargement stock:",t),M.Am.error("Erreur lors du chargement du stock")}},fe=async()=>{try{const t=(0,w.IO)((0,w.hJ)(k.db,"campaigns"),(0,w.ar)("hospitalId","==",null===e||void 0===e?void 0:e.id)),s=(await(0,w.PL)(t)).docs.map((e=>{var t,s;const a=e.data(),l=(null===(t=a.startDate)||void 0===t?void 0:t.toDate())||new Date,r=(null===(s=a.endDate)||void 0===s?void 0:s.toDate())||new Date,n=new Date;let i=a.status;return i=n>=l&&n<=r?"active":n>r?"completed":"upcoming",{id:e.id,...a,startDate:l,endDate:r,status:i}}));O(s),console.log("Campagnes charg\xe9es:",s.length,"dont",s.filter((e=>"active"===e.status)).length,"actives")}catch(t){console.error("Erreur chargement campagnes:",t),M.Am.error("Erreur lors du chargement des campagnes")}},je=async()=>{try{const t=(0,w.IO)((0,w.hJ)(k.db,"donationRequests"),(0,w.ar)("adminId","==",null===e||void 0===e?void 0:e.id)),s=(await(0,w.PL)(t)).docs.map((e=>{var t;return{id:e.id,...e.data(),createdAt:(null===(t=e.data().createdAt)||void 0===t?void 0:t.toDate())||new Date}}));L(s),console.log("Demandes de don charg\xe9es:",s.length,"pour admin:",null===e||void 0===e?void 0:e.id)}catch(t){M.Am.error("Erreur lors du chargement des demandes")}finally{H(!1)}},Ne=e=>{const t=e||ae;if(!t)return;const s="\ud83e\ude78 Campagne de don de sang : ".concat(t.title,"\n\n").concat(t.description,"\n\n\ud83d\udccd Lieu: ").concat(t.location.address,"\n\ud83d\udcc5 Du ").concat(t.startDate.toLocaleDateString()," au ").concat(t.endDate.toLocaleDateString(),"\n\nVenez donner votre sang et sauver des vies ! \ud83d\udcaa\u2764\ufe0f"),a="https://www.facebook.com/sharer/sharer.php?u=".concat(encodeURIComponent(window.location.origin),"&quote=").concat(encodeURIComponent(s));window.open(a,"_blank","width=600,height=400")},we=e=>{const t=e||ae;if(!t)return;const s="\ud83e\ude78 *Campagne de don de sang*\n\n*".concat(t.title,"*\n\n").concat(t.description,"\n\n\ud83d\udccd *Lieu:* ").concat(t.location.address,"\n\ud83d\udcc5 *P\xe9riode:* Du ").concat(t.startDate.toLocaleDateString()," au ").concat(t.endDate.toLocaleDateString(),"\n\nVenez donner votre sang et sauver des vies ! \ud83d\udcaa\u2764\ufe0f\n\nPlus d'infos: ").concat(window.location.origin),a="https://wa.me/?text=".concat(encodeURIComponent(s));window.open(a,"_blank")},ke=e=>{const t=I.filter((t=>t.bloodType===e&&"available"===t.status)).length;return 0===t?{level:"critical",color:"red"}:t<=2?{level:"low",color:"yellow"}:t<=5?{level:"medium",color:"blue"}:{level:"high",color:"green"}},De=[{id:"stock",label:"Stock de Sang",icon:n.Z},{id:"campaigns",label:"Campagnes",icon:i.Z},{id:"donations",label:"Demandes de Don",icon:o.Z},{id:"appointments",label:"Rendez-vous",icon:i.Z},{id:"stats",label:"Statistiques",icon:d},{id:"profile",label:"Profil",icon:m.Z}],Ee=["A+","A-","B+","B-","AB+","AB-","O+","O-"];return(0,a.jsx)(E.Z,{requiredRole:"admin",children:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)(r.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center mr-3",children:(0,a.jsx)(m.Z,{className:"text-white",size:20})}),(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Dashboard Administrateur"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(S.Z,{variant:"ghost",onClick:()=>oe(!0),className:"text-sm text-gray-600 hover:text-gray-900",children:ce.name||(null===e||void 0===e?void 0:e.displayName)}),(0,a.jsx)(S.Z,{variant:"ghost",onClick:t,children:"D\xe9connexion"})]})]})})})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm border mb-8",children:[(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-8 px-6",children:De.map((e=>{const t=e.icon;return(0,a.jsxs)("button",{onClick:()=>Z(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center ".concat(c===e.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,a.jsx)(t,{size:20,className:"mr-2"}),e.label]},e.id)}))})}),(0,a.jsxs)("div",{className:"p-6",children:["stock"===c&&(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Gestion du Stock de Sang"}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(S.Z,{variant:"outline",onClick:()=>Q(!0),className:"text-red-600 hover:text-red-700 border-red-200 hover:border-red-300",children:[(0,a.jsx)(u,{size:20,className:"mr-2"}),"Retirer en lot"]}),(0,a.jsxs)(S.Z,{onClick:()=>X(!0),children:[(0,a.jsx)(x.Z,{size:20,className:"mr-2"}),"Ajouter une poche"]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Ee.map((e=>{const t=ke(e),s=I.filter((t=>t.bloodType===e&&"available"===t.status)).length;return(0,a.jsx)(r.E.div,{whileHover:{scale:1.05},transition:{type:"spring",stiffness:300},children:(0,a.jsx)(A,{bloodType:e,count:s,maxCount:20,level:t.level})},e)}))}),(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold mb-4",children:"Stock D\xe9taill\xe9"}),(0,a.jsxs)("div",{className:"grid gap-3 max-h-96 overflow-y-auto",children:[I.filter((e=>"available"===e.status)).map((e=>(0,a.jsxs)(r.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"flex items-center justify-between bg-gray-50 rounded-lg p-4 border",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white text-sm font-bold",style:{backgroundColor:ke(e.bloodType).color.replace("text-","#")},children:e.bloodType}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.serialNumber}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[e.volume,"ml \u2022 ",e.ville," \u2022 Expire le ",e.expiryDate.toLocaleDateString()]})]})]}),(0,a.jsxs)(S.Z,{variant:"destructive",size:"sm",onClick:()=>(async(e,t)=>{if(confirm("\xcates-vous s\xfbr de vouloir retirer cette poche ".concat(t," ?")))try{await(0,w.oe)((0,w.JU)(k.db,"poche",e)),M.Am.success("Poche retir\xe9e avec succ\xe8s"),be()}catch(s){console.error("Erreur suppression poche:",s),M.Am.error("Erreur lors de la suppression")}})(e.id,e.bloodType),className:"flex items-center space-x-1",children:[(0,a.jsx)(p.Z,{size:16}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Retirer"})]})]},e.id))),0===I.filter((e=>"available"===e.status)).length&&(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(n.Z,{size:48,className:"mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{children:"Aucune poche disponible"})]})]})]})]}),"campaigns"===c&&(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Campagnes de Collecte"}),(0,a.jsxs)(S.Z,{onClick:()=>Y(!0),children:[(0,a.jsx)(x.Z,{size:20,className:"mr-2"}),"Nouvelle campagne"]})]}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 text-sm",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Debug:"})," ",R.length," campagnes trouv\xe9es"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Actives:"})," ",R.filter((e=>"active"===e.status)).length]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"\xc0 venir:"})," ",R.filter((e=>"upcoming"===e.status)).length]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Termin\xe9es:"})," ",R.filter((e=>"completed"===e.status)).length]})]}),(0,a.jsx)("div",{className:"grid gap-6",children:0===R.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(i.Z,{size:48,className:"mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{children:"Aucune campagne cr\xe9\xe9e"})]}):R.map((e=>(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gray-50 rounded-xl p-6 border",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.title}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-2",children:[(0,a.jsx)(h.Z,{size:16,className:"mr-1"}),e.location.address]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,a.jsx)(i.Z,{size:16,className:"mr-1"}),e.startDate.toLocaleDateString()," - ",e.endDate.toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"inline-flex px-3 py-1 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-green-100 text-green-800":"upcoming"===e.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.status}),(0,a.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:[e.currentDonors,"/",e.maxDonors," donneurs"]})]})]}),"active"===e.status&&(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600 font-medium",children:"Partager cette campagne:"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>Ne(e),className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:[(0,a.jsx)(g,{size:16,className:"mr-1"}),"Facebook"]}),(0,a.jsxs)("button",{onClick:()=>we(e),className:"flex items-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",children:[(0,a.jsx)(v.Z,{size:16,className:"mr-1"}),"WhatsApp"]})]})]})})]},e.id)))})]}),"donations"===c&&(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Demandes de Don Re\xe7ues"}),(0,a.jsx)("div",{className:"space-y-4",children:B.map((e=>(0,a.jsx)(r.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-gray-50 rounded-xl p-6 border",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center text-white font-bold text-sm mr-3",children:e.bloodType}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:e.userName||"Donneur anonyme"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.userEmail})]})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-2",children:["Candidature re\xe7ue le ",e.createdAt.toLocaleDateString()]}),e.eligibilityTest&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"\ud83d\udccb Test d'\xe9ligibilit\xe9"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs text-blue-800",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"\xc2ge:"})," ",e.eligibilityTest.age," ans"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Poids:"})," ",e.eligibilityTest.weight," kg"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Score:"})," ",e.eligibilityTest.score,"/100"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"\xc9ligible:"})," ",e.eligibilityTest.eligible?"\u2705 Oui":"\u274c Non"]}),e.eligibilityTest.lastDonation&&(0,a.jsxs)("p",{className:"col-span-2",children:[(0,a.jsx)("strong",{children:"Dernier don:"})," ",new Date(e.eligibilityTest.lastDonation).toLocaleDateString()]})]})]}),(0,a.jsx)("div",{className:"mt-2",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 rounded-full text-xs font-medium ".concat("campaign"===e.donationType?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"),children:"campaign"===e.donationType?"\ud83d\uddd3\ufe0f Campagne":"\ud83e\ude78 Don direct"})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(S.Z,{variant:"outline",size:"sm",children:"Voir d\xe9tails"}),"pending"===e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{variant:"secondary",size:"sm",onClick:()=>{se(e),ee(!0)},children:"\ud83d\udcc5 Programmer RDV"}),(0,a.jsx)(S.Z,{variant:"ghost",size:"sm",children:"Rejeter"})]}),"approved"===e.status&&e.appointmentId&&(0,a.jsx)("span",{className:"text-green-600 text-sm font-medium",children:"\u2705 RDV programm\xe9"})]})]})},e.id)))})]}),"appointments"===c&&(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Gestion des Rendez-vous"}),(0,a.jsx)(S.Z,{onClick:()=>ye(),children:"\ud83d\udd04 Actualiser"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[(0,a.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"\ud83d\udcc5 Programm\xe9s"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-700",children:F.filter((e=>"scheduled"===e.status)).length})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[(0,a.jsx)("h4",{className:"font-medium text-green-900 mb-2",children:"\u2705 Confirm\xe9s"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-700",children:F.filter((e=>"confirmed"===e.status)).length})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg border border-yellow-200",children:[(0,a.jsx)("h4",{className:"font-medium text-yellow-900 mb-2",children:"\u23f3 Aujourd'hui"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-yellow-700",children:F.filter((e=>new Date(e.appointmentDate).toDateString()===(new Date).toDateString())).length})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:0===F.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(i.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,a.jsx)("p",{className:"text-lg font-medium mb-2",children:"Aucun rendez-vous programm\xe9"}),(0,a.jsx)("p",{className:"text-sm",children:"Les rendez-vous programm\xe9s appara\xeetront ici"})]}):F.map((e=>{var t,s;return(0,a.jsx)(r.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-white rounded-xl p-6 border shadow-sm",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center mb-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-red-600 rounded-full flex items-center justify-center text-white font-bold mr-3",children:"\ud83d\udc64"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:e.userName}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:e.userEmail})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"\ud83d\udcc5 Date et heure"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[e.appointmentDate.toLocaleDateString()," \xe0 ",e.appointmentTime]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Dur\xe9e: ",e.duration," minutes"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"\ud83d\udccd Lieu"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:(null===(t=e.location)||void 0===t?void 0:t.address)||"Adresse principale"}),(null===(s=e.location)||void 0===s?void 0:s.room)&&(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Salle: ",e.location.room,e.location.floor&&" - \xc9tage: ".concat(e.location.floor)]})]})]}),e.notes&&(0,a.jsx)("div",{className:"bg-yellow-50 p-3 rounded-lg border border-yellow-200 mb-3",children:(0,a.jsxs)("p",{className:"text-sm text-yellow-800",children:[(0,a.jsx)("strong",{children:"\ud83d\udcdd Notes:"})," ",e.notes]})})]}),(0,a.jsxs)("div",{className:"flex flex-col items-end space-y-2",children:[(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat("scheduled"===e.status?"bg-blue-100 text-blue-800":"confirmed"===e.status?"bg-green-100 text-green-800":"completed"===e.status?"bg-gray-100 text-gray-800":"cancelled"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:"scheduled"===e.status?"\ud83d\udcc5 Programm\xe9":"confirmed"===e.status?"\u2705 Confirm\xe9":"completed"===e.status?"\u2713 Termin\xe9":"cancelled"===e.status?"\u274c Annul\xe9":"\u26a0\ufe0f Absent"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:["scheduled"===e.status&&(0,a.jsx)(S.Z,{variant:"outline",size:"sm",children:"\u2705 Confirmer"}),"completed"!==e.status&&"cancelled"!==e.status&&(0,a.jsx)(S.Z,{variant:"ghost",size:"sm",children:"\u274c Annuler"})]})]})]})},e.id)}))})]}),"stats"===c&&(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Statistiques et Rapports"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(S.Z,{variant:"outline",onClick:()=>{Promise.all([s.e(125),s.e(505),s.e(758)]).then(s.bind(s,3375)).then((t=>{let{jsPDF:s}=t;const a=new s;a.setFontSize(20),a.text("Rapport de Stock de Sang",20,20),a.setFontSize(12),a.text("G\xe9n\xe9r\xe9 le: ".concat((new Date).toLocaleDateString()),20,40),a.text("H\xf4pital: ".concat((null===e||void 0===e?void 0:e.displayName)||"Non sp\xe9cifi\xe9"),20,50);let l=80;a.setFontSize(14),a.text("Type de Sang",20,l),a.text("Quantit\xe9",80,l),a.text("Volume (ml)",130,l),a.text("Statut",170,l),l+=10,a.line(20,l,190,l),l+=10;["A+","A-","B+","B-","AB+","AB-","O+","O-"].forEach((e=>{const t=I.filter((t=>t.bloodType===e&&"available"===t.status)),s=t.reduce(((e,t)=>e+t.volume),0),{level:r}=ke(e);a.setFontSize(12),a.text(e,20,l),a.text(t.length.toString(),80,l),a.text(s.toString(),130,l),a.text(r,170,l),l+=15})),a.save("rapport-stock-sang.pdf"),M.Am.success("Rapport PDF export\xe9 avec succ\xe8s!")}))},children:[(0,a.jsx)(y,{size:20,className:"mr-2"}),"Export PDF"]}),(0,a.jsxs)(S.Z,{variant:"outline",onClick:()=>{Promise.all([s.e(425),s.e(919)]).then(s.bind(s,2093)).then((e=>{const t=[["Type de Sang","Quantit\xe9","Volume (ml)","Statut"],...["A+","A-","B+","B-","AB+","AB-","O+","O-"].map((e=>{const t=I.filter((t=>t.bloodType===e&&"available"===t.status)),s=t.reduce(((e,t)=>e+t.volume),0),{level:a}=ke(e);return[e,t.length,s,a]}))],s=e.utils.aoa_to_sheet(t),a=e.utils.book_new();e.utils.book_append_sheet(a,s,"Stock de Sang"),e.writeFile(a,"rapport-stock-sang.xlsx"),M.Am.success("Rapport Excel export\xe9 avec succ\xe8s!")}))},children:[(0,a.jsx)(b,{size:20,className:"mr-2"}),"Export Excel"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,a.jsxs)(r.E.div,{className:"relative rounded-xl overflow-hidden h-32 bg-red-600",animate:{boxShadow:["0 4px 15px rgba(239, 68, 68, 0.3)","0 8px 25px rgba(239, 68, 68, 0.4)","0 4px 15px rgba(239, 68, 68, 0.3)"]},transition:{duration:1,repeat:1/0,repeatType:"reverse"},children:[(0,a.jsx)(r.E.div,{className:"absolute inset-0 bg-gradient-to-br from-red-400 to-red-700",animate:{y:[0,-2,2,0],scale:[1,1.02,.98,1],rotate:[0,.5,-.5,0]},transition:{duration:1,repeat:1/0}}),(0,a.jsxs)("div",{className:"relative z-10 h-full flex flex-col items-center justify-center text-white",children:[(0,a.jsx)("p",{className:"text-red-100 text-sm mb-1",children:"Total Poches"}),(0,a.jsx)("p",{className:"text-4xl font-bold",children:I.length}),(0,a.jsx)(n.Z,{size:20,className:"text-red-200 mt-1"})]})]}),(0,a.jsxs)(r.E.div,{className:"relative rounded-xl overflow-hidden h-32 bg-green-600",animate:{boxShadow:["0 4px 15px rgba(34, 197, 94, 0.3)","0 8px 25px rgba(34, 197, 94, 0.4)","0 4px 15px rgba(34, 197, 94, 0.3)"]},transition:{duration:1,repeat:1/0,repeatType:"reverse",delay:.25},children:[(0,a.jsx)(r.E.div,{className:"absolute inset-0 bg-gradient-to-br from-green-400 to-green-700",animate:{y:[0,2,-2,0],scale:[1,.98,1.02,1],rotate:[0,-.5,.5,0]},transition:{duration:1,repeat:1/0,delay:.25}}),(0,a.jsxs)("div",{className:"relative z-10 h-full flex flex-col items-center justify-center text-white",children:[(0,a.jsx)("p",{className:"text-green-100 text-sm mb-1",children:"Disponibles"}),(0,a.jsx)("p",{className:"text-4xl font-bold",children:I.filter((e=>"available"===e.status)).length}),(0,a.jsx)(d,{size:20,className:"text-green-200 mt-1"})]})]}),(0,a.jsxs)(r.E.div,{className:"relative rounded-xl overflow-hidden h-32 bg-blue-600",animate:{boxShadow:["0 4px 15px rgba(59, 130, 246, 0.3)","0 8px 25px rgba(59, 130, 246, 0.4)","0 4px 15px rgba(59, 130, 246, 0.3)"]},transition:{duration:1,repeat:1/0,repeatType:"reverse",delay:.5},children:[(0,a.jsx)(r.E.div,{className:"absolute inset-0 bg-gradient-to-br from-blue-400 to-blue-700",animate:{y:[0,-1,1,0],scale:[1,1.01,.99,1],rotate:[0,.3,-.3,0]},transition:{duration:1,repeat:1/0,delay:.5}}),(0,a.jsxs)("div",{className:"relative z-10 h-full flex flex-col items-center justify-center text-white",children:[(0,a.jsx)("p",{className:"text-blue-100 text-sm mb-1",children:"Campagnes actives"}),(0,a.jsx)("p",{className:"text-4xl font-bold",children:R.filter((e=>"active"===e.status)).length}),(0,a.jsx)(i.Z,{size:20,className:"text-blue-200 mt-1"})]})]}),(0,a.jsxs)(r.E.div,{className:"relative rounded-xl overflow-hidden h-32 bg-purple-600",animate:{boxShadow:["0 4px 15px rgba(147, 51, 234, 0.3)","0 8px 25px rgba(147, 51, 234, 0.4)","0 4px 15px rgba(147, 51, 234, 0.3)"]},transition:{duration:1,repeat:1/0,repeatType:"reverse",delay:.75},children:[(0,a.jsx)(r.E.div,{className:"absolute inset-0 bg-gradient-to-br from-purple-400 to-purple-700",animate:{y:[0,1,-1,0],scale:[1,.99,1.01,1],rotate:[0,-.3,.3,0]},transition:{duration:1,repeat:1/0,delay:.75}}),(0,a.jsxs)("div",{className:"relative z-10 h-full flex flex-col items-center justify-center text-white",children:[(0,a.jsx)("p",{className:"text-purple-100 text-sm mb-1",children:"En attente"}),(0,a.jsx)("p",{className:"text-4xl font-bold",children:B.filter((e=>"pending"===e.status)).length}),(0,a.jsx)(o.Z,{size:20,className:"text-purple-200 mt-1"})]})]})]}),(0,a.jsx)(T,{data:(()=>{const e={"A+":"#DC2626","A-":"#EF4444","B+":"#7C3AED","B-":"#8B5CF6","AB+":"#059669","AB-":"#10B981","O+":"#EA580C","O-":"#F97316"},t=I.filter((e=>"available"===e.status)),s=t.length;return Ee.map((a=>{const l=t.filter((e=>e.bloodType===a)).length;return{bloodType:a,count:l,percentage:s>0?l/s*100:0,color:e[a]}}))})()}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 border",children:[(0,a.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,a.jsx)(f,{className:"text-red-600 mr-2",size:20}),"Niveaux de Stock Critiques"]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Ee.map((e=>"critical"===ke(e).level?(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-center",children:[(0,a.jsx)("div",{className:"text-red-600 font-bold text-lg",children:e}),(0,a.jsx)("div",{className:"text-red-800 text-sm",children:"Stock critique"})]},e):null))})]})]}),"profile"===c&&(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Profil Administrateur"}),(0,a.jsx)(S.Z,{onClick:()=>oe(!0),children:"Modifier le profil"})]}),(0,a.jsx)("div",{className:"bg-white rounded-xl p-6 border",children:(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom de l'\xe9tablissement"}),(0,a.jsx)("p",{className:"text-lg text-gray-900",children:ce.name||(null===e||void 0===e?void 0:e.displayName)||"Non d\xe9fini"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Num\xe9ro de t\xe9l\xe9phone"}),(0,a.jsx)("p",{className:"text-lg text-gray-900",children:ce.phone||"Non d\xe9fini"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse"}),(0,a.jsx)("p",{className:"text-lg text-gray-900",children:ce.address||"Non d\xe9finie"})]}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,a.jsx)("p",{className:"text-lg text-gray-900",children:null===e||void 0===e?void 0:e.email})]})]})}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Information importante :"}),(0,a.jsx)("p",{className:"text-sm text-blue-800",children:"Ces informations seront affich\xe9es sur toutes vos campagnes pour permettre aux donneurs de vous contacter directement."})]})]})]})]})}),U&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cr\xe9er une nouvelle campagne"}),(0,a.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),xe.title&&xe.description&&xe.address)if(0!==xe.latitude&&0!==xe.longitude)if(0!==xe.targetBloodTypes.length)try{console.log("Cr\xe9ation campagne avec donn\xe9es:",xe);const t={title:xe.title,description:xe.description,hospitalId:(null===e||void 0===e?void 0:e.id)||(null===e||void 0===e?void 0:e.hospitalId),hospitalName:ce.name||(null===e||void 0===e?void 0:e.displayName)||"H\xf4pital",adminContact:{name:ce.name||(null===e||void 0===e?void 0:e.displayName)||"H\xf4pital",phone:ce.phone||"Non renseign\xe9",address:ce.address||"Non renseign\xe9e"},location:{address:xe.address,latitude:xe.latitude,longitude:xe.longitude},targetBloodTypes:xe.targetBloodTypes,startDate:new Date(xe.startDate),endDate:new Date(xe.endDate),status:"upcoming",maxDonors:xe.maxDonors,currentDonors:0,registeredDonors:[],createdAt:new Date,updatedAt:new Date,createdBy:null===e||void 0===e?void 0:e.id},s=await(0,w.ET)((0,w.hJ)(k.db,"campaigns"),t);console.log("Campagne cr\xe9\xe9e avec ID:",s.id),M.Am.success("Campagne cr\xe9\xe9e avec succ\xe8s"),Y(!1),le({...t,id:s.id}),K(!0),pe({title:"",description:"",address:"",latitude:0,longitude:0,targetBloodTypes:[],startDate:"",endDate:"",maxDonors:50}),fe()}catch(s){console.error("Erreur cr\xe9ation campagne:",s),M.Am.error("Erreur lors de la cr\xe9ation: ".concat(s instanceof Error?s.message:"Erreur inconnue"))}else M.Am.error("Veuillez s\xe9lectionner au moins un type de sang");else M.Am.error("Veuillez s\xe9lectionner une position sur la carte");else M.Am.error("Veuillez remplir tous les champs obligatoires")},className:"space-y-4",children:[(0,a.jsx)(C.Z,{type:"text",label:"Titre de la campagne",placeholder:"Collecte de sang urgente",value:xe.title,onChange:e=>pe({...xe,title:e.target.value}),required:!0}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,a.jsx)("textarea",{value:xe.description,onChange:e=>pe({...xe,description:e.target.value}),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",rows:3,placeholder:"Description de la campagne...",required:!0})]}),(0,a.jsx)(q,{label:"Adresse de la campagne",placeholder:"Tapez une adresse au Cameroun...",value:xe.address,onChange:(e,t)=>{pe({...xe,address:e,latitude:(null===t||void 0===t?void 0:t.lat)||xe.latitude,longitude:(null===t||void 0===t?void 0:t.lng)||xe.longitude})},required:!0}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Position sur la carte"}),(0,a.jsx)(z.Z,{latitude:xe.latitude,longitude:xe.longitude,onLocationSelect:(e,t)=>{pe({...xe,latitude:e,longitude:t})}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Types de sang recherch\xe9s"}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-2",children:Ee.map((e=>(0,a.jsxs)("label",{className:"flex items-center p-2 border rounded-lg cursor-pointer hover:bg-gray-50",children:[(0,a.jsx)("input",{type:"checkbox",checked:xe.targetBloodTypes.includes(e),onChange:t=>{t.target.checked?pe({...xe,targetBloodTypes:[...xe.targetBloodTypes,e]}):pe({...xe,targetBloodTypes:xe.targetBloodTypes.filter((t=>t!==e))})},className:"mr-2"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:e})]},e)))})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(C.Z,{type:"date",label:"Date de d\xe9but",value:xe.startDate,onChange:e=>pe({...xe,startDate:e.target.value}),required:!0}),(0,a.jsx)(C.Z,{type:"date",label:"Date de fin",value:xe.endDate,onChange:e=>pe({...xe,endDate:e.target.value}),required:!0})]}),(0,a.jsx)(C.Z,{type:"number",label:"Nombre maximum de donneurs",value:xe.maxDonors,onChange:e=>pe({...xe,maxDonors:parseInt(e.target.value)}),min:"10",max:"200",required:!0}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)(S.Z,{type:"button",variant:"ghost",onClick:()=>Y(!1),className:"flex-1",children:"Annuler"}),(0,a.jsx)(S.Z,{type:"submit",variant:"primary",className:"flex-1",disabled:0===xe.targetBloodTypes.length||0===xe.latitude,children:"Cr\xe9er la campagne"})]})]})]})}),J&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl p-6 w-full max-w-md",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Ajouter une poche de sang"}),(0,a.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),e)try{const t={bloodType:me.bloodType,volume:me.volume,collectionDate:new Date(me.collectionDate),expiryDate:new Date(me.expiryDate),hospitalId:null===e||void 0===e?void 0:e.id,hospitalName:ce.name||(null===e||void 0===e?void 0:e.displayName)||"H\xf4pital",ville:me.ville,status:"available",donorId:null,serialNumber:"".concat(me.bloodType,"-").concat(Date.now()),createdAt:new Date,updatedAt:new Date,createdBy:null===e||void 0===e?void 0:e.id},s=await(0,w.ET)((0,w.hJ)(k.db,"poche"),t);console.log("Poche ajout\xe9e avec ID:",s.id),M.Am.success("Poche de sang ajout\xe9e avec succ\xe8s"),ue({bloodType:"O+",volume:450,collectionDate:(new Date).toISOString().split("T")[0],expiryDate:"",ville:""}),X(!1),be()}catch(s){console.error("Erreur ajout poche:",s),M.Am.error("Erreur lors de l'ajout de la poche")}},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Groupe sanguin"}),(0,a.jsx)("select",{value:me.bloodType,onChange:e=>ue({...me,bloodType:e.target.value}),className:"w-full px-3 py-3 border border-gray-300 rounded-lg",children:Ee.map((e=>(0,a.jsx)("option",{value:e,children:e},e)))})]}),(0,a.jsx)(C.Z,{type:"number",label:"Volume (ml)",value:me.volume,onChange:e=>ue({...me,volume:parseInt(e.target.value)}),min:"350",max:"500",required:!0}),(0,a.jsx)(C.Z,{type:"date",label:"Date de collecte",value:me.collectionDate,onChange:e=>ue({...me,collectionDate:e.target.value}),required:!0}),(0,a.jsx)(C.Z,{type:"date",label:"Date d'expiration",value:me.expiryDate,onChange:e=>ue({...me,expiryDate:e.target.value}),required:!0}),(0,a.jsx)(C.Z,{type:"text",label:"Ville de collecte",value:me.ville,onChange:e=>ue({...me,ville:e.target.value}),placeholder:"Ex: Yaound\xe9, Douala...",required:!0}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)(S.Z,{type:"button",variant:"ghost",onClick:()=>X(!1),className:"flex-1",children:"Annuler"}),(0,a.jsx)(S.Z,{type:"submit",variant:"primary",className:"flex-1",children:"Ajouter"})]})]})]})}),ie&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl p-6 w-full max-w-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Modifier le profil"}),(0,a.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{console.log("\ud83d\udcbe Sauvegarde du profil admin:",ce);const t=(0,w.JU)(k.db,"adminProfiles",(null===e||void 0===e?void 0:e.id)||"");await(0,w.pl)(t,{userId:null===e||void 0===e?void 0:e.id,name:ce.name,phone:ce.phone,address:ce.address,email:null===e||void 0===e?void 0:e.email,updatedAt:new Date,createdAt:new Date},{merge:!0}),console.log("\u2705 Profil sauvegard\xe9 avec succ\xe8s"),M.Am.success("Profil mis \xe0 jour avec succ\xe8s"),oe(!1)}catch(s){console.error("\u274c Erreur lors de la mise \xe0 jour du profil:",s),s instanceof Error&&console.error("Message d'erreur:",s.message),M.Am.error("Erreur lors de la mise \xe0 jour: ".concat(s instanceof Error?s.message:"Erreur inconnue"))}},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom de l'\xe9tablissement *"}),(0,a.jsx)("input",{type:"text",value:ce.name,onChange:e=>de({...ce,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",placeholder:"H\xf4pital Central de Yaound\xe9",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Num\xe9ro de t\xe9l\xe9phone *"}),(0,a.jsx)("input",{type:"tel",value:ce.phone,onChange:e=>de({...ce,phone:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",placeholder:"+237 6XX XX XX XX",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adresse compl\xe8te"}),(0,a.jsx)("textarea",{value:ce.address,onChange:e=>de({...ce,address:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500",rows:3,placeholder:"Rue, quartier, ville..."})]}),(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:(0,a.jsx)("p",{className:"text-sm text-yellow-800",children:"\u2139\ufe0f Ces informations seront visibles par les donneurs sur vos campagnes pour vous contacter."})}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)(S.Z,{type:"button",variant:"ghost",onClick:()=>oe(!1),className:"flex-1",children:"Annuler"}),(0,a.jsx)(S.Z,{type:"submit",variant:"primary",className:"flex-1",children:"Sauvegarder"})]})]})]})}),G&&ae&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl p-6 w-full max-w-md",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsxs)("h3",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[(0,a.jsx)(j,{size:24,className:"mr-2 text-primary-600"}),"Partager la campagne"]}),(0,a.jsx)("button",{onClick:()=>K(!1),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(N.Z,{size:20})})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:ae.title}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:ae.description}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["\ud83d\udccd ",ae.location.address]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(S.Z,{onClick:()=>Ne(),className:"w-full bg-blue-600 hover:bg-blue-700 text-white flex items-center justify-center",children:[(0,a.jsx)(g,{size:20,className:"mr-2"}),"Partager sur Facebook"]}),(0,a.jsxs)(S.Z,{onClick:()=>we(),className:"w-full bg-green-600 hover:bg-green-700 text-white flex items-center justify-center",children:[(0,a.jsx)(v.Z,{size:20,className:"mr-2"}),"Partager sur WhatsApp"]}),(0,a.jsx)(S.Z,{variant:"outline",onClick:()=>K(!1),className:"w-full",children:"Fermer"})]})]})}),W&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl p-6 w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[(0,a.jsx)(u,{size:20,className:"mr-2 text-red-500"}),"Retirer des poches par groupe sanguin"]}),(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:Ee.map((e=>{const t=I.filter((t=>t.bloodType===e&&"available"===t.status)).length;return(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"text-center mb-3",children:[(0,a.jsx)("h4",{className:"font-semibold text-lg",children:e}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:[t," disponible(s)"]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Nombre \xe0 retirer"}),(0,a.jsx)("input",{type:"number",min:"0",max:t,value:re[e]||0,onChange:s=>ne((a=>({...a,[e]:Math.min(parseInt(s.target.value)||0,t)}))),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",disabled:0===t}),t>0&&(0,a.jsxs)("div",{className:"flex gap-1",children:[(0,a.jsx)("button",{type:"button",onClick:()=>ne((s=>({...s,[e]:Math.min((s[e]||0)+1,t)}))),className:"flex-1 px-2 py-1 bg-gray-100 hover:bg-gray-200 rounded text-xs",children:"+1"}),(0,a.jsx)("button",{type:"button",onClick:()=>ne((s=>({...s,[e]:t}))),className:"flex-1 px-2 py-1 bg-red-100 hover:bg-red-200 text-red-700 rounded text-xs",children:"Tout"})]})]})]},e)}))}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[(0,a.jsx)("h4",{className:"font-semibold mb-2",children:"R\xe9sum\xe9 du retrait"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["Total \xe0 retirer: ",(0,a.jsxs)("span",{className:"font-semibold text-red-600",children:[Object.values(re).reduce(((e,t)=>e+t),0)," poche(s)"]})]}),Object.entries(re).map((e=>{let[t,s]=e;return s>0&&(0,a.jsxs)("div",{className:"text-sm",children:[t,": ",s," poche(s)"]},t)}))]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)(S.Z,{onClick:async()=>{const e=Object.values(re).reduce(((e,t)=>e+t),0);if(0===e)return void M.Am.error("Veuillez s\xe9lectionner au moins une poche \xe0 retirer");const t="\xcates-vous s\xfbr de vouloir retirer ".concat(e," poche(s) de sang ?");if(confirm(t))try{let e=0;for(const[t,s]of Object.entries(re))if(s>0){const a=I.filter((e=>e.bloodType===t&&"available"===e.status)).slice(0,s);for(const t of a)await(0,w.oe)((0,w.JU)(k.db,"poche",t.id)),e++}M.Am.success("".concat(e," poche(s) retir\xe9e(s) avec succ\xe8s")),ne({}),Q(!1),be()}catch(s){console.error("Erreur suppression en lot:",s),M.Am.error("Erreur lors de la suppression en lot")}},disabled:0===Object.values(re).reduce(((e,t)=>e+t),0),className:"flex-1 bg-red-600 hover:bg-red-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirmer le retrait"}),(0,a.jsx)(S.Z,{variant:"outline",onClick:()=>{Q(!1),ne({})},className:"flex-1",children:"Annuler"})]})]})}),$&&te&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsx)(r.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"\ud83d\udcc5 Programmer un Rendez-vous"}),(0,a.jsx)("button",{onClick:()=>{ee(!1),se(null)},className:"text-gray-400 hover:text-gray-600",children:"\u2715"})]}),(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200 mb-6",children:[(0,a.jsx)("h3",{className:"font-medium text-blue-900 mb-2",children:"\ud83d\udc64 Informations du donneur"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Nom:"})," ",te.userName]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Email:"})," ",te.userEmail]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Groupe sanguin:"})," ",te.bloodType]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"H\xf4pital choisi:"})," ",te.hospitalName]})]})]})]}),(0,a.jsxs)("form",{onSubmit:t=>{t.preventDefault();const s=new Date(he.appointmentDate),a=he.appointmentTime,l=he.duration,r=he.location.address,n=he.location.room,i=he.location.floor,o=he.notes;(async t=>{if(!(null===e||void 0===e?void 0:e.id)||!te)return console.error("\u274c Donn\xe9es manquantes:",{userId:null===e||void 0===e?void 0:e.id,selectedDonation:te}),void M.Am.error("Erreur: utilisateur ou donation non s\xe9lectionn\xe9e");console.log("\ud83d\udcc5 Programmation du rendez-vous...",{appointmentData:t,selectedDonation:{id:te.id,userId:te.userId,userName:te.userName,userEmail:te.userEmail},hospitalInfo:{id:e.id,name:ce.name||(null===e||void 0===e?void 0:e.displayName)||"H\xf4pital"}});try{const s={donationRequestId:t.donationRequestId,userId:te.userId,userName:te.userName,userEmail:te.userEmail,hospitalId:e.id,hospitalName:ce.name||(null===e||void 0===e?void 0:e.displayName)||"H\xf4pital",appointmentDate:t.appointmentDate,appointmentTime:t.appointmentTime,duration:t.duration,location:t.location,notes:t.notes,status:"scheduled",createdAt:new Date,updatedAt:new Date};console.log("\ud83d\udcbe Sauvegarde dans Firestore:",s);const a=await(0,w.ET)((0,w.hJ)(k.db,"appointments"),s);console.log("\u2705 Rendez-vous cr\xe9\xe9 avec ID:",a.id);const l=(0,w.JU)(k.db,"donationRequests",t.donationRequestId);await(0,w.r7)(l,{status:"approved",appointmentId:a.id,updatedAt:new Date}),console.log("\u2705 Demande de don mise \xe0 jour"),M.Am.success("\ud83c\udf89 Rendez-vous programm\xe9 avec succ\xe8s!"),console.log("\ud83d\udd04 Actualisation des donn\xe9es..."),await je(),await ye(),ge({appointmentDate:(new Date).toISOString().split("T")[0],appointmentTime:"09:00",duration:30,notes:"",location:{address:"",room:"",floor:"",coordinates:null}}),ee(!1),se(null),console.log("\ud83c\udfc1 Processus termin\xe9 avec succ\xe8s")}catch(s){console.error("\u274c Erreur d\xe9taill\xe9e lors de la programmation:",s),s instanceof Error&&(console.error("Message d'erreur:",s.message),console.error("Stack trace:",s.stack)),M.Am.error("Erreur: ".concat(s instanceof Error?s.message:"Impossible de programmer le rendez-vous"))}})({donationRequestId:te.id,appointmentDate:s,appointmentTime:a,duration:l,location:{address:r,room:n||void 0,floor:i||void 0},notes:o||void 0})},className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"\ud83d\udcc5 Date du rendez-vous"}),(0,a.jsx)("input",{type:"date",value:he.appointmentDate,onChange:e=>ge({...he,appointmentDate:e.target.value}),required:!0,min:(new Date).toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"\ud83d\udd50 Heure du rendez-vous"}),(0,a.jsx)("input",{type:"time",value:he.appointmentTime,onChange:e=>ge({...he,appointmentTime:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"\u23f1\ufe0f Dur\xe9e (minutes)"}),(0,a.jsxs)("select",{value:he.duration,onChange:e=>ge({...he,duration:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",children:[(0,a.jsx)("option",{value:"30",children:"30 minutes"}),(0,a.jsx)("option",{value:"45",children:"45 minutes"}),(0,a.jsx)("option",{value:"60",children:"1 heure"}),(0,a.jsx)("option",{value:"90",children:"1h 30min"}),(0,a.jsx)("option",{value:"120",children:"2 heures"})]})]}),(0,a.jsx)(q,{label:"\ud83d\udccd Adresse du lieu",placeholder:"Tapez l'adresse de l'h\xf4pital...",value:he.location.address,onChange:(e,t)=>{ge({...he,location:{...he.location,address:e,coordinates:t||null}})},required:!0,className:"mb-4"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"\ud83c\udfe0 Salle (optionnel)"}),(0,a.jsx)("input",{type:"text",value:he.location.room,onChange:e=>ge({...he,location:{...he.location,room:e.target.value}}),placeholder:"Num\xe9ro de salle",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"\ud83c\udfe2 \xc9tage (optionnel)"}),(0,a.jsx)("input",{type:"text",value:he.location.floor,onChange:e=>ge({...he,location:{...he.location,floor:e.target.value}}),placeholder:"Num\xe9ro d'\xe9tage",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"\ud83d\udcdd Notes (optionnel)"}),(0,a.jsx)("textarea",{value:he.notes,onChange:e=>ge({...he,notes:e.target.value}),rows:3,placeholder:"Instructions sp\xe9ciales, pr\xe9parations n\xe9cessaires...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,a.jsx)(S.Z,{type:"button",variant:"ghost",onClick:()=>{ee(!1),se(null)},children:"Annuler"}),(0,a.jsx)(S.Z,{type:"submit",variant:"primary",children:"\ud83d\udcc5 Programmer le rendez-vous"})]})]})]})})})]})})}}},function(e){e.O(0,[358,139,341,847,390,971,117,744],(function(){return t=8858,e(e.s=t);var t}));var t=e.O();_N_E=t}]);