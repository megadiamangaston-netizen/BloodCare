(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[95],{8092:function(e,r,t){Promise.resolve().then(t.bind(t,4291))},8906:function(e,r,t){"use strict";t.d(r,{Z:function(){return a}});const a=(0,t(9763).Z)("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]])},4291:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return d}});var a=t(7437),s=t(2265),n=t(4603),o=t(6334),i=t(2827),c=t(8906);const l=(0,t(9763).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);function d(){const{createFirstSuperAdmin:e,user:r}=(0,n.a)(),[t,d]=(0,s.useState)(""),[u,m]=(0,s.useState)(!1);return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 w-full max-w-md",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(c.Z,{className:"text-purple-600",size:32})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Configuration Super Admin"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Promouvoir un utilisateur existant en super administrateur"})]}),"super_admin"===(null===r||void 0===r?void 0:r.role)?(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(l,{className:"text-green-600",size:32})}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Vous \xeates d\xe9j\xe0 Super Admin !"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Vous pouvez acc\xe9der au dashboard super admin."}),(0,a.jsx)(o.Z,{onClick:()=>window.location.href="/super-admin",className:"w-full",children:"Acc\xe9der au Dashboard"})]}):(0,a.jsxs)("form",{onSubmit:async r=>{r.preventDefault(),m(!0);try{await e(t)}catch(a){console.error("Error promoting user:",a)}finally{m(!1)}},className:"space-y-6",children:[(0,a.jsx)(i.Z,{type:"email",label:"Email de l'utilisateur \xe0 promouvoir",placeholder:"admin@exemple.com",value:t,onChange:e=>d(e.target.value),required:!0,disabled:u}),(0,a.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,a.jsxs)("p",{className:"text-sm text-yellow-800",children:[(0,a.jsx)("strong",{children:"\u26a0\ufe0f Important :"})," Cette page est temporaire. L'utilisateur doit d\xe9j\xe0 avoir un compte dans l'application. Supprimez cette page apr\xe8s avoir configur\xe9 votre premier super admin."]})}),(0,a.jsx)(o.Z,{type:"submit",disabled:u||!t,className:"w-full",children:u?"Promotion en cours...":"Promouvoir en Super Admin"})]}),(0,a.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200",children:(0,a.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"BloodCare - Configuration initiale"})})]})})}},6334:function(e,r,t){"use strict";var a=t(7437),s=t(2265),n=t(429);const o=(0,s.forwardRef)(((e,r)=>{let{variant:t="primary",size:s="md",loading:o=!1,children:i,className:c="",...l}=e;return(0,a.jsxs)(n.E.button,{ref:r,whileHover:{scale:1.02},whileTap:{scale:.98},className:"".concat("inline-flex items-center justify-center font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"bg-primary-600 hover:bg-primary-700 text-white focus:ring-primary-500",secondary:"bg-secondary-600 hover:bg-secondary-700 text-white focus:ring-secondary-500",outline:"border-2 border-primary-600 text-primary-600 hover:bg-primary-600 hover:text-white focus:ring-primary-500",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500",destructive:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500"}[t]," ").concat({sm:"px-3 py-2 text-sm",md:"px-4 py-2.5 text-base",lg:"px-6 py-3 text-lg"}[s]," ").concat(c),disabled:o||l.disabled,...l,children:[o&&(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),i]})}));o.displayName="Button",r.Z=o},2827:function(e,r,t){"use strict";var a=t(7437);const s=(0,t(2265).forwardRef)(((e,r)=>{let{label:t,error:s,icon:n,className:o="",...i}=e;return(0,a.jsxs)("div",{className:"w-full",children:[t&&(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t}),(0,a.jsxs)("div",{className:"relative",children:[n&&(0,a.jsx)("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:n}),(0,a.jsx)("input",{ref:r,className:"\n              w-full px-3 py-3 border border-gray-300 rounded-lg \n              focus:ring-2 focus:ring-primary-500 focus:border-transparent\n              placeholder-gray-400 transition-all duration-200\n              ".concat(n?"pl-10":"","\n              ").concat(s?"border-red-500 ring-2 ring-red-200":"","\n              ").concat(o,"\n            "),...i})]}),s&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:s})]})}));s.displayName="Input",r.Z=s},4603:function(e,r,t){"use strict";t.d(r,{H:function(){return d},a:function(){return u}});var a=t(7437),s=t(2265),n=t(3301),o=t(5978),i=t(6410),c=t(9064);const l=(0,s.createContext)(void 0);function d(e){let{children:r}=e;const[t,d]=(0,s.useState)(null),[u,m]=(0,s.useState)(null),[p,h]=(0,s.useState)(!0);(0,s.useEffect)((()=>{const e=(0,n.Aj)(i.I8,(async e=>{if(m(e),e)try{const a=await(0,o.QT)((0,o.JU)(i.db,"users",e.uid));if(a.exists()){var r,t;const s=a.data();d({id:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:s.role||"user",hospitalId:s.hospitalId,createdAt:(null===(r=s.createdAt)||void 0===r?void 0:r.toDate())||new Date,updatedAt:(null===(t=s.updatedAt)||void 0===t?void 0:t.toDate())||new Date})}else{const r={id:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:"user",createdAt:new Date,updatedAt:new Date};await(0,o.pl)((0,o.JU)(i.db,"users",e.uid),{...r,createdAt:new Date,updatedAt:new Date}),d(r)}}catch(s){var a;if(console.error("Error fetching user data:",s),"unavailable"===s.code||(null===(a=s.message)||void 0===a?void 0:a.includes("offline"))){console.warn("Firestore hors ligne - cr\xe9ation d'un utilisateur local temporaire");const r={id:e.uid,email:e.email,displayName:e.displayName||"Utilisateur",photoURL:e.photoURL,role:"user",createdAt:new Date,updatedAt:new Date};d(r),c.ZP.success("Mode hors ligne activ\xe9")}else c.ZP.error("Erreur lors du chargement des donn\xe9es utilisateur")}else d(null);h(!1)}));return()=>e()}),[]);const x={user:t,firebaseUser:u,loading:p,signInWithEmail:async(e,r)=>{try{await(0,n.e5)(i.I8,e,r),c.ZP.success("Connexion r\xe9ussie !")}catch(t){throw console.error("Error signing in:",t),c.ZP.error("Erreur de connexion : "+t.message),t}},signInWithGoogle:async()=>{try{await(0,n.rh)(i.I8,i.Vv),c.ZP.success("Connexion Google r\xe9ussie !")}catch(e){throw console.error("Error signing in with Google:",e),c.ZP.error("Erreur de connexion Google : "+e.message),e}},signUpWithEmail:async(e,r,t)=>{try{const{user:a}=await(0,n.Xb)(i.I8,e,r);await(0,n.ck)(a,{displayName:t});const s={id:a.uid,email:a.email,displayName:t,role:"user",createdAt:new Date,updatedAt:new Date};await(0,o.pl)((0,o.JU)(i.db,"users",a.uid),{...s,createdAt:new Date,updatedAt:new Date}),c.ZP.success("Compte cr\xe9\xe9 avec succ\xe8s !")}catch(a){throw console.error("Error signing up:",a),c.ZP.error("Erreur lors de la cr\xe9ation du compte : "+a.message),a}},logout:async()=>{try{await(0,n.w7)(i.I8),c.ZP.success("D\xe9connexion r\xe9ussie")}catch(e){console.error("Error signing out:",e),c.ZP.error("Erreur lors de la d\xe9connexion")}},updateUserRole:async(e,r)=>{try{await(0,o.r7)((0,o.JU)(i.db,"users",e),{role:r,updatedAt:new Date}),c.ZP.success("R\xf4le utilisateur mis \xe0 jour")}catch(t){throw console.error("Error updating user role:",t),c.ZP.error("Erreur lors de la mise \xe0 jour du r\xf4le"),t}},createFirstSuperAdmin:async e=>{try{const r=(await(0,o.PL)((0,o.hJ)(i.db,"users"))).docs.find((r=>r.data().email===e));r?(await(0,o.r7)((0,o.JU)(i.db,"users",r.id),{role:"super_admin",updatedAt:new Date}),c.ZP.success("Super admin cr\xe9\xe9 avec succ\xe8s"),window.location.reload()):c.ZP.error("Utilisateur non trouv\xe9")}catch(r){console.error("Error creating super admin:",r),c.ZP.error("Erreur lors de la cr\xe9ation du super admin")}}};return(0,a.jsx)(l.Provider,{value:x,children:r})}function u(){const e=(0,s.useContext)(l);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}},6410:function(e,r,t){"use strict";t.d(r,{I8:function(){return c},Vv:function(){return l},db:function(){return d}});var a=t(738),s=t(3301),n=t(5978),o=t(62);const i=(0,a.ZF)({apiKey:"AIzaSyBLpLQIqKcWgUVYDttXit1x5nRrcFB1RmM",authDomain:"hemoconnect-ec751.firebaseapp.com",projectId:"hemoconnect-ec751",storageBucket:"hemoconnect-ec751.firebasestorage.app",messagingSenderId:"324649213432",appId:"1:324649213432:web:77683bec35f3fe9b4a8a0d"}),c=(0,s.v0)(i),l=new s.hJ;l.setCustomParameters({prompt:"select_account"});const d=(0,n.ad)(i);(0,o.cF)(i)}},function(e){e.O(0,[358,139,341,710,971,117,744],(function(){return r=8092,e(e.s=r);var r}));var r=e.O();_N_E=r}]);