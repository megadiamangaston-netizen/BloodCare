(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{8016:function(e,s,t){Promise.resolve().then(t.bind(t,9789))},9789:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return E}});var a=t(7437),i=t(2265),r=t(429),n=t(3774),l=t(1047),d=t(3247),o=t(3417),c=t(8997),m=t(7414),x=t(4766),u=t(2489),h=t(6927),g=t(5805),p=t(6595),b=t(2222),j=t(5978),v=t(6410),y=t(4603),N=t(3002),f=t(6334),w=t(2827),D=t(5095),S=t(4743);function C(e){let{isOpen:s,onClose:t}=e;const[n,l]=(0,i.useState)([{id:"1",content:"Bonjour ! Je suis votre assistant BloodCare aliment\xe9 par Gemini Flash 1.5. Je peux r\xe9pondre \xe0 vos questions sur le don de sang, les crit\xe8res d'\xe9ligibilit\xe9, et vous guider dans vos d\xe9marches. Comment puis-je vous aider ?",isBot:!0,timestamp:new Date}]),[d,o]=(0,i.useState)(""),[c,m]=(0,i.useState)(!1),[x,h]=(0,i.useState)([]),g=async()=>{if(!d.trim())return;const e={id:Date.now().toString(),content:d,isBot:!1,timestamp:new Date};l((s=>[...s,e]));const s=d;o(""),m(!0);try{const e=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:s,history:x})}),t=(await e.json()).response,a={id:(Date.now()+1).toString(),content:t,isBot:!0,timestamp:new Date};l((e=>[...e,a])),h((e=>[...e,{role:"user",content:s},{role:"model",content:t}]))}catch(t){console.error("Erreur lors de l'envoi du message:",t);const e={id:(Date.now()+1).toString(),content:"D\xe9sol\xe9, je rencontre une difficult\xe9 technique. Pouvez-vous reformuler votre question ou contacter notre \xe9quipe m\xe9dicale pour une assistance imm\xe9diate ?",isBot:!0,timestamp:new Date};l((s=>[...s,e]))}finally{m(!1)}};return(0,a.jsx)(D.M,{children:s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:t}),(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.8,x:100,y:100},animate:{opacity:1,scale:1,x:0,y:0},exit:{opacity:0,scale:.8,x:100,y:100},className:"fixed bottom-4 right-4 w-80 md:w-96 h-[500px] bg-white rounded-2xl shadow-2xl border z-50 flex flex-col",children:[(0,a.jsx)("div",{className:"p-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-t-2xl",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center mr-3",children:(0,a.jsx)(b.Z,{size:20})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Assistant BloodCare"}),(0,a.jsx)("p",{className:"text-xs opacity-90",children:"Aliment\xe9 par Gemini Flash 1.5"})]})]}),(0,a.jsx)("button",{onClick:t,className:"p-1 hover:bg-white hover:bg-opacity-20 rounded",children:(0,a.jsx)(u.Z,{size:20})})]})}),1===n.length&&(0,a.jsxs)("div",{className:"p-4 border-b bg-gray-50",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600 mb-3",children:"Questions fr\xe9quentes :"}),(0,a.jsx)("div",{className:"space-y-2",children:["Qui peut donner son sang ?","Combien de temps entre deux dons ?","Quels sont les crit\xe8res d'\xe9ligibilit\xe9 ?","Comment se d\xe9roule un don de sang ?","Puis-je donner si je prends des m\xe9dicaments ?","Quels sont les groupes sanguins compatibles ?"].slice(0,3).map(((e,s)=>(0,a.jsx)("button",{onClick:()=>(e=>{o(e)})(e),className:"block w-full text-left text-xs bg-white border border-gray-200 rounded-lg p-2 hover:bg-gray-50 transition-colors",children:e},s)))})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n.map((e=>(0,a.jsx)(r.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex ".concat(e.isBot?"justify-start":"justify-end"),children:(0,a.jsxs)("div",{className:"max-w-[80%] rounded-2xl px-4 py-2 ".concat(e.isBot?"bg-gray-100 text-gray-800":"bg-blue-600 text-white"),children:[(0,a.jsx)("p",{className:"text-sm",children:e.content}),(0,a.jsx)("p",{className:"text-xs mt-1 ".concat(e.isBot?"text-gray-500":"text-blue-100"),children:e.timestamp.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]})},e.id))),c&&(0,a.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"flex justify-start",children:(0,a.jsx)("div",{className:"bg-gray-100 rounded-2xl px-4 py-2",children:(0,a.jsxs)("div",{className:"flex space-x-1",children:[(0,a.jsx)(r.E.div,{animate:{scale:[1,1.2,1]},transition:{duration:.6,repeat:1/0,delay:0},className:"w-2 h-2 bg-gray-400 rounded-full"}),(0,a.jsx)(r.E.div,{animate:{scale:[1,1.2,1]},transition:{duration:.6,repeat:1/0,delay:.2},className:"w-2 h-2 bg-gray-400 rounded-full"}),(0,a.jsx)(r.E.div,{animate:{scale:[1,1.2,1]},transition:{duration:.6,repeat:1/0,delay:.4},className:"w-2 h-2 bg-gray-400 rounded-full"})]})})})]}),(0,a.jsx)("div",{className:"p-4 border-t bg-gray-50 rounded-b-2xl",children:(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("input",{type:"text",value:d,onChange:e=>o(e.target.value),onKeyPress:e=>"Enter"===e.key&&g(),placeholder:"Posez votre question...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-xl text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,a.jsx)(f.Z,{onClick:g,variant:"primary",size:"sm",disabled:!d.trim()||c,className:"px-3",children:(0,a.jsx)(S.Z,{size:16})})]})})]})]})})}var k=t(2190),z=t(3041),Z=t(9345);function A(e){let{onHospitalSelect:s,selectedHospital:t,bloodType:l,className:d=""}=e;const[o,c]=(0,i.useState)([]),[m,x]=(0,i.useState)([]),[u,p]=(0,i.useState)(""),[b,y]=(0,i.useState)(!0),[N,D]=(0,i.useState)(!1);(0,i.useEffect)((()=>{S()}),[]),(0,i.useEffect)((()=>{C()}),[o,u,N,l]);const S=async()=>{try{const e=(await(0,j.PL)((0,j.hJ)(v.db,"hospitals"))).docs.map((e=>({id:e.id,...e.data()}))),s=(await(0,j.PL)((0,j.hJ)(v.db,"admins"))).docs.map((e=>({id:e.id,...e.data()}))),t=e.map((e=>{const t=s.find((s=>s.hospitalId===e.id)),a=t&&t.bloodStock?t.bloodStock:{"A+":0,"A-":0,"B+":0,"B-":0,"AB+":0,"AB-":0,"O+":0,"O-":0},i=Object.values(a).reduce(((e,s)=>e+(s||0)),0);return{...e,bloodStock:a,totalStock:i}}));c(t)}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration des h\xf4pitaux:",e)}finally{y(!1)}},C=()=>{let e=o;u&&(e=e.filter((e=>e.name.toLowerCase().includes(u.toLowerCase())||e.address.toLowerCase().includes(u.toLowerCase())))),N&&l&&(e=e.filter((e=>e.bloodStock[l]&&e.bloodStock[l]>0))),e.sort(((e,s)=>s.totalStock-e.totalStock)),x(e)},k=["A+","A-","B+","B-","AB+","AB-","O+","O-"];return b?(0,a.jsxs)("div",{className:"flex items-center justify-center py-8 ".concat(d),children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-500"}),(0,a.jsx)("span",{className:"ml-3 text-gray-600",children:"Chargement des \xe9tablissements..."})]}):(0,a.jsx)("div",{className:d,children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(w.Z,{type:"text",placeholder:"Rechercher un \xe9tablissement...",value:u,onChange:e=>p(e.target.value),className:"w-full"})}),l&&(0,a.jsxs)(f.Z,{variant:N?"primary":"outline",onClick:()=>D(!N),className:"whitespace-nowrap",children:[(0,a.jsx)(h.Z,{size:16,className:"mr-2"}),"Stock ",l," disponible"]})]}),(0,a.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:0===m.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(g.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,a.jsx)("p",{className:"text-lg font-medium mb-2",children:"Aucun \xe9tablissement trouv\xe9"}),(0,a.jsx)("p",{className:"text-sm",children:u?'Aucun \xe9tablissement ne correspond \xe0 "'.concat(u,'"'):N?"Aucun \xe9tablissement n'a de stock ".concat(l," disponible"):"Aucun \xe9tablissement disponible"})]}):m.map((e=>(0,a.jsx)(r.E.div,{whileHover:{scale:1.02},className:"p-4 border rounded-lg cursor-pointer transition-all ".concat((null===t||void 0===t?void 0:t.id)===e.id?"border-red-500 bg-red-50 shadow-md":"border-gray-200 hover:border-red-300 hover:shadow-sm"),onClick:()=>s(e),children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mr-3",children:e.name}),(0,a.jsxs)("div",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full",children:[e.totalStock," poches total"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[(0,a.jsx)(n.Z,{size:14,className:"mr-1"}),e.address]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600 mb-1",children:[(0,a.jsx)(z.Z,{size:14,className:"mr-1"}),e.phone]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(Z.Z,{size:14,className:"mr-1"}),e.email]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"text-sm font-medium text-gray-800 mb-2",children:"\ud83e\ude78 Stocks disponibles :"}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-1 text-xs",children:k.map((s=>{const t=e.bloodStock[s]||0;return(0,a.jsxs)("div",{className:"text-center px-1 py-1 rounded ".concat(s===l&&t>0?"bg-red-100 text-red-800 font-bold":t>0?"bg-green-100 text-green-800":"bg-gray-100 text-gray-500"),children:[(0,a.jsx)("div",{className:"font-medium",children:s}),(0,a.jsx)("div",{children:t})]},s)}))}),l&&e.bloodStock[l]>0&&(0,a.jsxs)("div",{className:"mt-2 text-xs text-green-700 bg-green-50 px-2 py-1 rounded border border-green-200",children:["\u2705 ",e.bloodStock[l]," poches ",l," disponibles"]})]})]})]}),(0,a.jsx)("div",{className:"w-5 h-5 rounded-full border-2 ml-4 mt-1 ".concat((null===t||void 0===t?void 0:t.id)===e.id?"border-red-500 bg-red-500":"border-gray-300")})]})},e.id)))}),(0,a.jsx)("div",{className:"text-sm text-gray-500 bg-blue-50 p-3 rounded-lg",children:(0,a.jsxs)("p",{children:["\ud83d\udca1 ",(0,a.jsx)("strong",{children:"Conseil :"})," S\xe9lectionnez l'\xe9tablissement le plus proche de chez vous ou celui ayant le plus de stock de votre groupe sanguin."]})})]})})}var T=t(9064);function E(){var e;const{user:s,logout:t}=(0,y.a)(),[D,S]=(0,i.useState)("campaigns"),[z,Z]=(0,i.useState)([]),[E,P]=(0,i.useState)([]),[L,R]=(0,i.useState)([]),[I,O]=(0,i.useState)([]),[B,q]=(0,i.useState)([]),[F,M]=(0,i.useState)(!1),[V,J]=(0,i.useState)("O+"),[H,_]=(0,i.useState)(!1),[Q,U]=(0,i.useState)(""),[G,K]=(0,i.useState)(5),[X,W]=(0,i.useState)(!1),[Y,$]=(0,i.useState)(!0),[ee,se]=(0,i.useState)(!1),[te,ae]=(0,i.useState)(null),[ie,re]=(0,i.useState)(0),[ne,le]=(0,i.useState)({age:18,weight:50,lastDonation:"",hasIllness:!1,takesMedication:!1,hasTraveled:!1}),[de,oe]=(0,i.useState)([]),[ce,me]=(0,i.useState)(null),[xe,ue]=(0,i.useState)(!1),[he,ge]=(0,i.useState)("O+"),[pe,be]=(0,i.useState)(""),[je,ve]=(0,i.useState)({lat:3.8667,lng:11.5167}),ye=["A+","A-","B+","B-","AB+","AB-","O+","O-"];(0,i.useEffect)((()=>{console.log("\ud83d\udd10 V\xe9rification authentification utilisateur:",s),s&&s.id?(console.log("\u2705 Utilisateur authentifi\xe9, chargement des donn\xe9es..."),Ne(),fe(),Se(),we(),Ce()):console.log("\u23f3 En attente de l'authentification...")}),[s]);const Ne=async()=>{try{console.log("\ud83d\udd04 D\xe9but du chargement des campagnes..."),console.log("\ud83d\udd0d Utilisateur actuel:",null===s||void 0===s?void 0:s.email,null===s||void 0===s?void 0:s.id),console.log("\ud83d\udd0d Configuration DB:",v.db);const e=(0,j.hJ)(v.db,"campaigns");console.log("\ud83d\udcc2 R\xe9f\xe9rence collection:",e),console.log("\ud83d\ude80 Ex\xe9cution de la requ\xeate Firestore...");const t=await(0,j.PL)(e);if(console.log("\ud83d\udcca Requ\xeate ex\xe9cut\xe9e. Documents trouv\xe9s:",t.docs.length),t.empty)return console.warn("\u26a0\ufe0f Collection vide ou permissions insuffisantes"),void T.ZP.error("Aucune campagne trouv\xe9e. V\xe9rifiez les permissions Firestore.");const a=t.docs.map(((e,s)=>{const a=e.data();console.log("\ud83d\udcc4 Document ".concat(s+1,"/").concat(t.docs.length,":"),{id:e.id,rawData:a,keys:Object.keys(a),hasTitle:!!a.title,hasStartDate:!!a.startDate,hasEndDate:!!a.endDate,hasLocation:!!a.location});try{var i,r;const s=(null===(i=a.startDate)||void 0===i?void 0:i.toDate)?a.startDate.toDate():new Date(a.startDate||Date.now()),t=(null===(r=a.endDate)||void 0===r?void 0:r.toDate)?a.endDate.toDate():new Date(a.endDate||Date.now()),n=new Date;console.log("\ud83d\udcc5 Dates pour ".concat(e.id,":"),{startDate:s.toISOString(),endDate:t.toISOString(),now:n.toISOString()});let l=a.status;return l=n>=s&&n<=t?"active":n>t?"completed":"upcoming",{id:e.id,title:a.title||"Campagne ".concat(e.id),description:a.description||"Aucune description",hospitalName:a.hospitalName||"H\xf4pital non sp\xe9cifi\xe9",location:a.location||{address:"Lieu non sp\xe9cifi\xe9",latitude:3.8667,longitude:11.5167},targetBloodTypes:a.targetBloodTypes||["O+"],maxDonors:a.maxDonors||50,currentDonors:a.currentDonors||0,...a,startDate:s,endDate:t,status:l}}catch(n){return console.error("\u274c Erreur traitement dates pour ".concat(e.id,":"),n),{id:e.id,title:a.title||"Campagne ".concat(e.id),description:"Erreur de format de dates",...a,startDate:new Date,endDate:new Date,status:"upcoming"}}}));Z(a),console.log("\u2705 Campagnes trait\xe9es et stock\xe9es:",a.length),console.log("\ud83d\udccb R\xe9sum\xe9 final:",a.map((e=>{var s,t,a;return{id:e.id,title:e.title,status:e.status,dateRange:"".concat(null===(s=e.startDate)||void 0===s?void 0:s.toLocaleDateString()," - ").concat(null===(t=e.endDate)||void 0===t?void 0:t.toLocaleDateString()),location:null===(a=e.location)||void 0===a?void 0:a.address}}))),a.length>0&&T.ZP.success("".concat(a.length," campagnes charg\xe9es avec succ\xe8s"))}catch(e){console.error("\u274c Erreur compl\xe8te chargement campagnes:",{error:e,message:e.message,code:e.code,stack:e.stack}),T.ZP.error("Erreur chargement: ".concat(e.message))}},fe=async()=>{try{console.log("\ud83d\udcdd Chargement des t\xe9moignages...");const e=await(0,j.PL)((0,j.IO)((0,j.hJ)(v.db,"testimonials"),(0,j.ar)("approved","==",!0),(0,j.Xo)("createdAt","desc")));console.log("\ud83d\udcc4 ".concat(e.docs.length," t\xe9moignages trouv\xe9s dans Firestore"));const s=e.docs.map((e=>{var s;const t=e.data();return console.log("\ud83d\udcdd T\xe9moignage:",{id:e.id,...t}),{id:e.id,...t,createdAt:(null===(s=t.createdAt)||void 0===s?void 0:s.toDate())||new Date}}));P(s),console.log("\u2705 ".concat(s.length," t\xe9moignages charg\xe9s et affich\xe9s"))}catch(e){console.error("\u274c Erreur lors du chargement des t\xe9moignages:",e),T.ZP.error("Erreur lors du chargement des t\xe9moignages")}},we=async()=>{try{if(!(null===s||void 0===s?void 0:s.id))return void console.log("\u23f3 fetchMyAppointments: Pas d'utilisateur connect\xe9");console.log("\ud83d\udcc5 Chargement des rendez-vous pour l'utilisateur:",s.id),console.log('\ud83d\udd0d Tentative de r\xe9cup\xe9ration depuis la collection "appointments"');const e=(0,j.IO)((0,j.hJ)(v.db,"appointments"),(0,j.ar)("userId","==",s.id));console.log("\ud83d\ude80 Ex\xe9cution de la requ\xeate Firestore...");const t=await(0,j.PL)(e);if(console.log("\ud83d\udcca ".concat(t.docs.length," documents trouv\xe9s dans la collection appointments")),t.empty)return console.warn("\u26a0\ufe0f Collection vide ou aucun rendez-vous pour cet utilisateur"),void O([]);const a=t.docs.map((e=>{const s=e.data();console.log("\ud83d\udcc4 Document rendez-vous trouv\xe9:",{id:e.id,userId:s.userId,hospitalName:s.hospitalName,appointmentDate:s.appointmentDate,appointmentTime:s.appointmentTime,status:s.status,allFields:Object.keys(s)});try{var t,a;return{id:e.id,...s,appointmentDate:(null===(t=s.appointmentDate)||void 0===t?void 0:t.toDate)?s.appointmentDate.toDate():new Date(s.appointmentDate),createdAt:(null===(a=s.createdAt)||void 0===a?void 0:a.toDate)?s.createdAt.toDate():new Date(s.createdAt||Date.now())}}catch(i){return console.error("\u274c Erreur conversion date pour le document:",e.id,i),{id:e.id,...s,appointmentDate:new Date,createdAt:new Date}}}));a.sort(((e,s)=>s.appointmentDate.getTime()-e.appointmentDate.getTime())),O(a),console.log("\u2705 ".concat(a.length," rendez-vous charg\xe9s et affect\xe9s au state")),console.log("\ud83d\udccb R\xe9sum\xe9 des rendez-vous:",a.map((e=>({id:e.id,date:e.appointmentDate.toLocaleDateString(),time:e.appointmentTime,hospital:e.hospitalName,status:e.status})))),De(a)}catch(e){console.error("\u274c Erreur compl\xe8te lors du chargement des rendez-vous:",e),e instanceof Error&&(console.error("Message d'erreur:",e.message),"code"in e&&console.error("Code d'erreur:",e.code),console.error("Stack trace:",e.stack))}},De=e=>{const s=[];e.forEach((e=>{const t=new Date(e.appointmentDate),a=new Date,i=t.getTime()-a.getTime(),r=Math.ceil(i/864e5);"scheduled"===e.status&&s.push({id:"appointment-scheduled-".concat(e.id),type:"appointment_scheduled",title:"\ud83d\udcc5 Nouveau rendez-vous programm\xe9",message:"Votre rendez-vous de don a \xe9t\xe9 programm\xe9 pour le ".concat(t.toLocaleDateString("fr-FR")," \xe0 ").concat(e.appointmentTime),appointmentId:e.id,createdAt:e.createdAt,read:!1}),"confirmed"===e.status&&s.push({id:"appointment-confirmed-".concat(e.id),type:"appointment_confirmed",title:"\u2705 Rendez-vous confirm\xe9",message:"Votre rendez-vous de don du ".concat(t.toLocaleDateString("fr-FR")," a \xe9t\xe9 confirm\xe9"),appointmentId:e.id,createdAt:e.createdAt,read:!1}),1!==r||"scheduled"!==e.status&&"confirmed"!==e.status||s.push({id:"appointment-reminder-".concat(e.id),type:"appointment_reminder",title:"\u23f0 Rappel - Rendez-vous demain",message:"N'oubliez pas votre rendez-vous de don demain \xe0 ".concat(e.appointmentTime," \xe0 ").concat(e.hospitalName),appointmentId:e.id,createdAt:new Date,read:!1}),0!==r||"scheduled"!==e.status&&"confirmed"!==e.status||s.push({id:"appointment-today-".concat(e.id),type:"appointment_today",title:"\ud83d\udea8 Rendez-vous aujourd'hui",message:"Votre rendez-vous de don est aujourd'hui \xe0 ".concat(e.appointmentTime,". Pr\xe9parez votre pi\xe8ce d'identit\xe9 !"),appointmentId:e.id,createdAt:new Date,read:!1})})),q(s)},Se=async()=>{try{const e=(0,j.IO)((0,j.hJ)(v.db,"donationRequests"),(0,j.ar)("userId","==",null===s||void 0===s?void 0:s.id)),t=(await(0,j.PL)(e)).docs.map((e=>{var s,t;return{id:e.id,...e.data(),createdAt:(null===(s=e.data().createdAt)||void 0===s?void 0:s.toDate())||new Date,scheduledDate:(null===(t=e.data().scheduledDate)||void 0===t?void 0:t.toDate())||null}}));R(t)}catch(e){T.ZP.error("Erreur lors du chargement de vos dons")}finally{$(!1)}},Ce=async()=>{try{const e=await(0,j.PL)((0,j.hJ)(v.db,"adminProfiles")),s=await(0,j.PL)((0,j.hJ)(v.db,"poche")),t={};s.docs.forEach((e=>{const s=e.data(),a=s.hospitalId||s.createdBy;t[a]||(t[a]={});const i=s.bloodType;t[a][i]||(t[a][i]=0),"available"===s.status&&(t[a][i]+=1)}));const a=e.docs.map((e=>({id:e.data().userId,name:e.data().name,phone:e.data().phone,address:e.data().address,email:e.data().email,bloodStock:t[e.data().userId]||{},totalStock:Object.values(t[e.data().userId]||{}).reduce(((e,s)=>e+s),0)})));oe(a),console.log("Admins avec stocks charg\xe9s:",a.length)}catch(e){console.error("Erreur chargement admins:",e),T.ZP.error("Erreur lors du chargement des \xe9tablissements")}},ke=()=>{let e=100;if((ne.age<18||ne.age>65)&&(e-=50),ne.weight<50&&(e-=30),ne.lastDonation){const s=new Date(ne.lastDonation);((new Date).getTime()-s.getTime())/864e5<56&&(e-=40)}return ne.hasIllness&&(e-=30),ne.takesMedication&&(e-=20),ne.hasTraveled&&(e-=15),{score:e,eligible:e>=70}},ze=e=>{ae(e||null),se(!0),le({age:18,weight:50,lastDonation:"",hasIllness:!1,takesMedication:!1,hasTraveled:!1})},Ze=async()=>{if(te)try{const e=ke(),t=z.find((e=>e.id===te));if(!t)return void T.ZP.error("Campagne introuvable");const a={userId:null===s||void 0===s?void 0:s.id,userName:null===s||void 0===s?void 0:s.displayName,userEmail:null===s||void 0===s?void 0:s.email,hospitalId:t.hospitalId,hospitalName:t.hospitalName,campaignId:te,bloodType:"O+",eligibilityTest:{...ne,lastDonation:ne.lastDonation?new Date(ne.lastDonation):null,score:e.score,eligible:e.eligible},status:"pending",donationType:"campaign",createdAt:new Date,updatedAt:new Date};await(0,j.ET)((0,j.hJ)(v.db,"donationRequests"),a),T.ZP.success('\ud83c\udf89 Candidature envoy\xe9e pour la campagne "'.concat(t.title,'" ! ').concat(t.hospitalName," vous contactera bient\xf4t.")),ae(null),Se()}catch(e){console.error("Erreur lors de l'envoi de la candidature:",e),T.ZP.error("Erreur lors de l'envoi de la candidature")}},Ae=[{id:"campaigns",label:"Campagnes",icon:n.Z},{id:"appointments",label:"Mes Rendez-vous",icon:l.Z},{id:"search",label:"Rechercher",icon:d.Z},{id:"testimonials",label:"T\xe9moignages",icon:o.Z},{id:"donations",label:"Mes Dons",icon:c.Z},{id:"rewards",label:"R\xe9compenses",icon:m.Z}];return(0,a.jsx)(N.Z,{requiredRole:"user",children:(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(r.E.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-red-600 rounded-lg flex items-center justify-center mr-3",children:(0,a.jsx)(c.Z,{className:"text-white",size:20})}),(0,a.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Mon Espace Donneur"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{onClick:()=>M(!F),className:"relative p-2 text-gray-600 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 rounded-full",children:[(0,a.jsx)(x.Z,{size:20}),B.filter((e=>!e.read)).length>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:B.filter((e=>!e.read)).length})]}),F&&(0,a.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg ring-1 ring-black ring-opacity-5 z-50",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),(0,a.jsx)("button",{onClick:()=>M(!1),className:"text-gray-400 hover:text-gray-600",children:(0,a.jsx)(u.Z,{size:20})})]})}),(0,a.jsx)("div",{className:"max-h-96 overflow-y-auto",children:0===B.length?(0,a.jsxs)("div",{className:"p-4 text-center text-gray-500",children:[(0,a.jsx)(x.Z,{className:"mx-auto h-8 w-8 text-gray-400 mb-2"}),(0,a.jsx)("p",{className:"text-sm",children:"Aucune notification"})]}):(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:B.sort(((e,s)=>new Date(s.createdAt).getTime()-new Date(e.createdAt).getTime())).map((e=>(0,a.jsx)("div",{className:"p-4 hover:bg-gray-50 cursor-pointer transition-colors ".concat(e.read?"":"bg-blue-50 border-l-4 border-blue-500"),onClick:()=>{var s;s=e.id,q((e=>e.map((e=>e.id===s?{...e,read:!0}:e)))),e.appointmentId&&(S("appointments"),M(!1))},children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"text-sm font-medium ".concat(e.read?"text-gray-900":"text-blue-900"),children:e.title}),(0,a.jsx)("p",{className:"text-sm mt-1 ".concat(e.read?"text-gray-600":"text-blue-700"),children:e.message}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:new Date(e.createdAt).toLocaleString("fr-FR")})]}),!e.read&&(0,a.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-2"})]})},e.id)))})}),B.filter((e=>!e.read)).length>0&&(0,a.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,a.jsx)("button",{onClick:()=>{q((e=>e.map((e=>({...e,read:!0})))))},className:"w-full text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Marquer tout comme lu"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(null===s||void 0===s?void 0:s.photoURL)?(0,a.jsx)("img",{src:s.photoURL,alt:s.displayName,className:"w-8 h-8 rounded-full"}):(0,a.jsx)("div",{className:"w-8 h-8 bg-red-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white text-sm font-medium",children:null===s||void 0===s||null===(e=s.displayName)||void 0===e?void 0:e.charAt(0).toUpperCase()})}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:null===s||void 0===s?void 0:s.displayName})]}),(0,a.jsx)(f.Z,{variant:"ghost",onClick:t,children:"D\xe9connexion"})]})]})})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl shadow-sm border mb-8",children:[(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsx)("nav",{className:"-mb-px flex space-x-8 px-6 overflow-x-auto",children:Ae.map((e=>{const s=e.icon;return(0,a.jsxs)("button",{onClick:()=>S(e.id),className:"py-4 px-1 border-b-2 font-medium text-sm flex items-center whitespace-nowrap ".concat(D===e.id?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,a.jsx)(s,{size:20,className:"mr-2"}),e.label]},e.id)}))})}),(0,a.jsxs)("div",{className:"p-6",children:["campaigns"===D&&(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Campagnes de Collecte Actives"}),(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[z.length," campagnes disponibles"]})]}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,a.jsxs)("h4",{className:"font-medium text-blue-900 mb-2 flex items-center",children:[(0,a.jsx)(c.Z,{className:"mr-2",size:20}),"Comment faire un don ?"]}),(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:["1. Cliquez sur ",(0,a.jsx)("strong",{children:'"Test d\'\xe9ligibilit\xe9"'})," sur une campagne qui vous int\xe9resse",(0,a.jsx)("br",{}),"2. Remplissez le questionnaire de sant\xe9",(0,a.jsx)("br",{}),"3. Si vous \xeates \xe9ligible, choisissez un h\xf4pital",(0,a.jsx)("br",{}),"4. Envoyez votre candidature et attendez la confirmation"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden",children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-red-500 to-blue-500 text-white p-4",children:(0,a.jsxs)("h4",{className:"font-semibold flex items-center",children:[(0,a.jsx)(n.Z,{size:20,className:"mr-2"}),"Carte des Campagnes au Cameroun"]})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"h-[600px] mb-6",children:(0,a.jsx)(k.Z,{latitude:je.lat,longitude:je.lng,onLocationSelect:(e,s)=>ve({lat:e,lng:s}),campaigns:z,showCampaigns:!0,className:"h-full"})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,a.jsx)(n.Z,{className:"mx-auto h-8 w-8 text-blue-600 mb-2"}),(0,a.jsxs)("p",{className:"text-sm font-medium text-blue-900",children:[z.length," campagnes sur la carte"]}),(0,a.jsx)("p",{className:"text-xs text-blue-700 mt-1",children:"Cliquez pour voir les d\xe9tails"})]}),z.slice(0,5).map(((e,s)=>{var t,i;return(0,a.jsxs)("div",{className:"text-center p-3 bg-gray-50 rounded-lg border hover:border-red-300 cursor-pointer transition-colors",children:[(0,a.jsx)("div",{className:"w-6 h-6 rounded-full mx-auto mb-2 flex items-center justify-center text-white text-xs font-bold ".concat("active"===e.status?"bg-red-500":"upcoming"===e.status?"bg-blue-500":"bg-green-500"),children:s+1}),(0,a.jsx)("p",{className:"text-xs text-gray-700 font-medium mb-1",children:e.title||"Campagne sans titre"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:(null===(i=e.location)||void 0===i||null===(t=i.address)||void 0===t?void 0:t.split(",")[0])||"Lieu non d\xe9fini"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:[e.currentDonors||0,"/",e.maxDonors||50]}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:e.hospitalName||"H\xf4pital"})]},e.id)}))]})]})]}),(0,a.jsxs)("div",{className:"grid gap-6",children:[(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 text-sm",children:[(0,a.jsx)("strong",{children:"Debug:"})," ",z.length," campagnes charg\xe9es",z.length>0&&(0,a.jsx)("div",{className:"mt-2 space-y-1",children:z.map((e=>{var s;return(0,a.jsxs)("div",{className:"text-xs",children:["\u2022 ",e.title," - Statut: ",e.status," - Lieu: ",(null===(s=e.location)||void 0===s?void 0:s.address)||"Non d\xe9fini"]},e.id)}))})]}),0===z.length?(0,a.jsxs)("div",{className:"text-center py-12 bg-white rounded-xl border",children:[(0,a.jsx)(l.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"Aucune campagne trouv\xe9e"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"V\xe9rifiez la console pour les d\xe9tails de debug"})]}):z.map((e=>{var s,t;return(0,a.jsx)(r.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-white to-red-50 rounded-xl p-6 border border-red-100 hover:shadow-lg transition-shadow",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.title}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:e.description}),(0,a.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(n.Z,{size:16,className:"mr-2 text-red-500"}),(null===(s=e.location)||void 0===s?void 0:s.address)||"Lieu \xe0 pr\xe9ciser"]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(l.Z,{size:16,className:"mr-2 text-blue-500"}),e.startDate.toLocaleDateString("fr-FR")," - ",e.endDate.toLocaleDateString("fr-FR")]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(h.Z,{size:16,className:"mr-2 text-purple-500"}),"Groupes recherch\xe9s: ",(null===(t=e.targetBloodTypes)||void 0===t?void 0:t.join(", "))||"Tous groupes"]}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,a.jsx)(g.Z,{size:16,className:"mr-2 text-green-500"}),"Organis\xe9 par: ",e.hospitalName||"H\xf4pital partenaire"]}),e.adminContact&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"\ud83d\udcde Contact"}),(0,a.jsxs)("div",{className:"space-y-1 text-xs text-blue-800",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"\xc9tablissement:"})," ",e.adminContact.name]}),e.adminContact.phone&&"Non renseign\xe9"!==e.adminContact.phone&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"T\xe9l\xe9phone:"})," ",e.adminContact.phone]}),e.adminContact.address&&"Non renseign\xe9e"!==e.adminContact.address&&(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Adresse:"})," ",e.adminContact.address]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-medium",children:e.currentDonors||0})," / ",e.maxDonors||100," donneurs"]}),(0,a.jsx)("div",{className:"w-32 bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-red-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat((e.currentDonors||0)/(e.maxDonors||100)*100,"%")}})})]})]}),(0,a.jsxs)("div",{className:"ml-6",children:[(0,a.jsx)(f.Z,{onClick:()=>{return s=e.id,void ze(s);var s},variant:"primary",size:"lg",className:"mb-2 bg-red-600 hover:bg-red-700 text-white font-semibold px-6 py-3",children:"\ud83e\ude78 Faire un Don"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"Test d'\xe9ligibilit\xe9 inclus"}),(0,a.jsx)("div",{className:"px-3 py-1 rounded-full text-xs font-medium text-center ".concat("active"===e.status?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"),children:"active"===e.status?"En cours":"\xc0 venir"})]})]})},e.id)}))]})]}),"appointments"===D&&(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Mes Rendez-vous de Don"}),(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[I.length," rendez-vous"]}),(0,a.jsx)(f.Z,{onClick:()=>{console.log("\ud83d\udd04 Test manuel de chargement des rendez-vous..."),we()},variant:"outline",size:"sm",children:"\ud83d\udd04 Recharger"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[(0,a.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"\ud83d\udcc5 Programm\xe9s"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-700",children:I.filter((e=>"scheduled"===e.status)).length})]}),(0,a.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[(0,a.jsx)("h4",{className:"font-medium text-green-900 mb-2",children:"\u2705 Confirm\xe9s"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-green-700",children:I.filter((e=>"confirmed"===e.status)).length})]}),(0,a.jsxs)("div",{className:"bg-purple-50 p-4 rounded-lg border border-purple-200",children:[(0,a.jsx)("h4",{className:"font-medium text-purple-900 mb-2",children:"\u2713 Termin\xe9s"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-purple-700",children:I.filter((e=>"completed"===e.status)).length})]})]}),(0,a.jsx)("div",{className:"space-y-4",children:0===I.length?(0,a.jsxs)("div",{className:"text-center py-12 bg-white rounded-xl border border-gray-200",children:[(0,a.jsx)(l.Z,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),(0,a.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun rendez-vous programm\xe9"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Vos rendez-vous de don appara\xeetront ici une fois qu'ils seront programm\xe9s par l'h\xf4pital."}),(0,a.jsx)(f.Z,{onClick:()=>S("campaigns"),className:"bg-red-600 hover:bg-red-700",children:"\ud83e\ude78 Voir les campagnes disponibles"})]}):(0,a.jsxs)(a.Fragment,{children:[I.filter((e=>new Date(e.appointmentDate)>=new Date&&("scheduled"===e.status||"confirmed"===e.status))).length>0&&(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,a.jsxs)("h4",{className:"font-medium text-blue-900 mb-3 flex items-center",children:[(0,a.jsx)(l.Z,{className:"mr-2",size:20}),"Prochains rendez-vous"]}),(0,a.jsx)("div",{className:"space-y-3",children:I.filter((e=>new Date(e.appointmentDate)>=new Date&&("scheduled"===e.status||"confirmed"===e.status))).slice(0,2).map((e=>(0,a.jsx)("div",{className:"bg-white p-3 rounded-lg border border-blue-300",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-blue-900",children:e.appointmentDate.toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),(0,a.jsxs)("p",{className:"text-sm text-blue-700",children:["\ud83d\udd50 ",e.appointmentTime," \u2022 \ud83d\udccd ",e.hospitalName]})]}),(0,a.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("confirmed"===e.status?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"),children:"confirmed"===e.status?"\u2705 Confirm\xe9":"\ud83d\udcc5 Programm\xe9"})]})},e.id)))})]}),I.map((e=>{var s,t;return(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-red-600 rounded-full flex items-center justify-center text-white font-bold mr-4",children:"\ud83e\ude78"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"font-semibold text-gray-900",children:["Rendez-vous de don - ",e.hospitalName]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Programm\xe9 le ",e.createdAt.toLocaleDateString()]})]})]}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("scheduled"===e.status?"bg-blue-100 text-blue-800":"confirmed"===e.status?"bg-green-100 text-green-800":"completed"===e.status?"bg-purple-100 text-purple-800":"cancelled"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:"scheduled"===e.status?"\ud83d\udcc5 Programm\xe9":"confirmed"===e.status?"\u2705 Confirm\xe9":"completed"===e.status?"\u2713 Termin\xe9":"cancelled"===e.status?"\u274c Annul\xe9":"\u26a0\ufe0f Absent"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"\ud83d\udcc5 Date et heure"}),(0,a.jsxs)("p",{className:"text-gray-900",children:[e.appointmentDate.toLocaleDateString("fr-FR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})," \xe0 ",e.appointmentTime]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Dur\xe9e estim\xe9e: ",e.duration," minutes"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"\ud83c\udfe5 Lieu"}),(0,a.jsx)("p",{className:"text-gray-900",children:e.hospitalName}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:(null===(s=e.location)||void 0===s?void 0:s.address)||"Adresse \xe0 confirmer"}),(null===(t=e.location)||void 0===t?void 0:t.room)&&(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Salle: ",e.location.room,e.location.floor&&" - \xc9tage: ".concat(e.location.floor)]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[e.notes&&(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"\ud83d\udcdd Instructions"}),(0,a.jsx)("div",{className:"bg-yellow-50 p-3 rounded-lg border border-yellow-200",children:(0,a.jsx)("p",{className:"text-sm text-yellow-800",children:e.notes})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"\ud83d\udccb Pr\xe9paration recommand\xe9e"}),(0,a.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,a.jsx)("li",{children:"\u2022 Bien dormir la nuit pr\xe9c\xe9dente"}),(0,a.jsx)("li",{children:"\u2022 Prendre un repas \xe9quilibr\xe9"}),(0,a.jsx)("li",{children:"\u2022 Boire beaucoup d'eau"}),(0,a.jsx)("li",{children:"\u2022 Apporter une pi\xe8ce d'identit\xe9"})]})]})]})]}),(0,a.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:new Date(e.appointmentDate)>new Date?"Dans ".concat(Math.ceil((new Date(e.appointmentDate).getTime()-(new Date).getTime())/864e5)," jour(s)"):new Date(e.appointmentDate).toDateString()===(new Date).toDateString()?"Aujourd'hui":"Pass\xe9"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:["scheduled"===e.status&&new Date(e.appointmentDate)>new Date&&(0,a.jsx)(f.Z,{variant:"outline",size:"sm",children:"\ud83d\udcde Contacter l'h\xf4pital"}),("scheduled"===e.status||"confirmed"===e.status)&&new Date(e.appointmentDate)>new Date&&(0,a.jsx)(f.Z,{variant:"ghost",size:"sm",className:"text-red-600",children:"\u274c Annuler"})]})]})})]},e.id)}))]})})]}),"search"===D&&(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"\ud83e\ude78 Rechercher des Poches de Sang"}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-6 border border-blue-200",children:[(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Groupe sanguin recherch\xe9"}),(0,a.jsx)("select",{value:V,onChange:e=>J(e.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:ye.map((e=>(0,a.jsx)("option",{value:e,children:e},e)))})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recherche par \xe9tablissement"}),(0,a.jsx)(w.Z,{placeholder:"Nom de l'\xe9tablissement...",value:pe,onChange:e=>be(e.target.value),className:"w-full"})]})]}),(0,a.jsx)("div",{className:"mt-4 p-3 bg-blue-100 border border-blue-300 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:["\ud83d\udca1 ",(0,a.jsx)("strong",{children:"Astuce :"})," Recherchez par groupe sanguin pour voir tous les \xe9tablissements qui ont ce type en stock, ou utilisez le nom pour trouver un \xe9tablissement sp\xe9cifique."]})})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 border",children:[(0,a.jsxs)("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[(0,a.jsx)(h.Z,{size:20,className:"mr-2 text-red-600"}),"\xc9tablissements avec du sang ",V," disponible",(0,a.jsxs)("span",{className:"ml-2 bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full",children:[de.filter((e=>(!pe||e.name.toLowerCase().includes(pe.toLowerCase()))&&e.bloodStock[V]>0)).length," trouv\xe9(s)"]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[de.filter((e=>{const s=!pe||e.name.toLowerCase().includes(pe.toLowerCase()),t=e.bloodStock[V]>0;return s&&t})).sort(((e,s)=>{const t=e.bloodStock[V]||0;return(s.bloodStock[V]||0)-t})).map((e=>(0,a.jsx)(r.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-4 bg-gradient-to-r from-white to-red-50 rounded-lg border border-red-100 hover:shadow-md transition-all duration-200",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center mb-3",children:[(0,a.jsx)("h5",{className:"font-medium text-gray-900 mr-3",children:e.name}),(0,a.jsxs)("div",{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full font-medium",children:[e.bloodStock[V]," poches ",V]}),(0,a.jsxs)("div",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full ml-2",children:[e.totalStock," total"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-1",children:["\ud83d\udccd ",e.address||"Adresse non renseign\xe9e"]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mb-1",children:["\ud83d\udcde ",e.phone||"T\xe9l\xe9phone non renseign\xe9"]}),(0,a.jsxs)("p",{className:"text-xs text-blue-600",children:["\u2709\ufe0f ",e.email]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h6",{className:"text-sm font-medium text-gray-800 mb-2",children:"Autres stocks disponibles :"}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-1 text-xs",children:ye.filter((e=>e!==V)).map((s=>{const t=e.bloodStock[s]||0;return(0,a.jsxs)("div",{className:"text-center px-1 py-1 rounded ".concat(t>0?"bg-green-100 text-green-800":"bg-gray-100 text-gray-500"),children:[(0,a.jsx)("div",{className:"font-medium",children:s}),(0,a.jsx)("div",{children:t})]},s)}))})]})]})]}),(0,a.jsx)(f.Z,{variant:"outline",size:"sm",onClick:()=>{me(e.id),ze()},className:"ml-4 bg-red-600 text-white hover:bg-red-700 border-red-600",children:"\ud83e\ude78 Faire un Don"})]})},e.id))),0===de.filter((e=>{const s=!pe||e.name.toLowerCase().includes(pe.toLowerCase()),t=e.bloodStock[V]>0;return s&&t})).length&&(0,a.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,a.jsx)(h.Z,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),(0,a.jsx)("p",{className:"text-lg font-medium mb-2",children:"Aucun \xe9tablissement trouv\xe9"}),(0,a.jsx)("p",{className:"text-sm mb-4",children:pe?'Aucun \xe9tablissement ne correspond \xe0 "'.concat(pe,'" avec du sang ').concat(V):"Aucun \xe9tablissement n'a de stock ".concat(V," disponible actuellement")}),(0,a.jsxs)("div",{className:"space-y-2 text-xs text-gray-400",children:[(0,a.jsx)("p",{children:"\ud83d\udca1 Suggestions :"}),(0,a.jsx)("p",{children:"\u2022 Essayez un autre groupe sanguin"}),(0,a.jsx)("p",{children:"\u2022 V\xe9rifiez l'orthographe du nom"}),(0,a.jsx)("p",{children:"\u2022 Effacez les filtres pour voir tous les \xe9tablissements"})]})]})]}),de.some((e=>e.totalStock>0))&&(0,a.jsxs)("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,a.jsx)("h5",{className:"font-medium text-green-900 mb-2 flex items-center",children:"\ud83d\udcca R\xe9sum\xe9 des stocks disponibles"}),(0,a.jsx)("div",{className:"grid grid-cols-4 md:grid-cols-8 gap-2 text-xs",children:ye.map((e=>{const s=de.reduce(((s,t)=>s+(t.bloodStock[e]||0)),0);return(0,a.jsxs)("div",{className:"text-center p-2 rounded ".concat(e===V?"bg-red-100 text-red-800 border border-red-300":s>0?"bg-green-100 text-green-800":"bg-gray-100 text-gray-500"),children:[(0,a.jsx)("div",{className:"font-bold",children:e}),(0,a.jsxs)("div",{children:[s," poches"]})]},e)}))})]})]})]}),"testimonials"===D&&(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"T\xe9moignages de la Communaut\xe9"}),(0,a.jsxs)(f.Z,{onClick:()=>_(!0),children:[(0,a.jsx)(o.Z,{size:20,className:"mr-2"}),"\xc9crire un t\xe9moignage"]})]}),(0,a.jsx)("div",{className:"grid gap-6",children:0===E.length?(0,a.jsxs)("div",{className:"text-center py-12 bg-white rounded-xl border border-gray-200",children:[(0,a.jsx)(o.Z,{className:"mx-auto h-16 w-16 text-gray-400 mb-4"}),(0,a.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Pas de t\xe9moignages pour le moment"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"Soyez le premier \xe0 partager votre exp\xe9rience de don de sang."}),(0,a.jsx)(f.Z,{onClick:()=>_(!0),className:"bg-red-600 hover:bg-red-700",children:"\ud83d\udcac \xc9crire le premier t\xe9moignage"})]}):E.map((e=>(0,a.jsx)(r.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white rounded-xl p-6 border shadow-sm",children:(0,a.jsxs)("div",{className:"flex items-start space-x-4",children:[e.userPhoto?(0,a.jsx)("img",{src:e.userPhoto,alt:e.userName,className:"w-12 h-12 rounded-full"}):(0,a.jsx)("div",{className:"w-12 h-12 bg-red-600 rounded-full flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-medium",children:e.userName.charAt(0).toUpperCase()})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h4",{className:"font-medium text-gray-900",children:e.userName}),(0,a.jsx)("div",{className:"flex items-center",children:[...Array(5)].map(((s,t)=>(0,a.jsx)(p.Z,{size:16,className:"".concat(t<e.rating?"text-yellow-400 fill-current":"text-gray-300")},t)))})]}),(0,a.jsx)("p",{className:"text-gray-700 mb-2",children:e.content}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.createdAt.toLocaleDateString()})]})]})},e.id)))})]}),"donations"===D&&(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Mes Dons de Sang"}),(0,a.jsx)(f.Z,{onClick:()=>ze(),variant:"primary",className:"bg-red-600 hover:bg-red-700 text-white font-semibold",children:"\ud83e\ude78 Proposer un Don"})]}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-red-50 to-pink-50 border border-red-200 rounded-lg p-6",children:(0,a.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(c.Z,{className:"w-6 h-6 text-red-600"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"text-lg font-semibold text-red-900 mb-2",children:"Faire un Don Spontan\xe9"}),(0,a.jsx)("p",{className:"text-red-800 mb-4",children:"Vous pouvez proposer votre don m\xeame sans campagne active ! Votre geste peut sauver des vies."}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h5",{className:"font-medium text-red-900",children:"Processus :"}),(0,a.jsxs)("ul",{className:"text-red-700 space-y-1",children:[(0,a.jsx)("li",{children:"\u2022 Test d'\xe9ligibilit\xe9 m\xe9dical"}),(0,a.jsx)("li",{children:"\u2022 S\xe9lection d'un h\xf4pital"}),(0,a.jsx)("li",{children:"\u2022 Candidature envoy\xe9e"}),(0,a.jsx)("li",{children:"\u2022 Confirmation par l'h\xf4pital"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h5",{className:"font-medium text-red-900",children:"Avantages :"}),(0,a.jsxs)("ul",{className:"text-red-700 space-y-1",children:[(0,a.jsx)("li",{children:"\u2022 Don quand vous \xeates disponible"}),(0,a.jsx)("li",{children:"\u2022 Contribution directe aux stocks"}),(0,a.jsx)("li",{children:"\u2022 Suivi personnalis\xe9"}),(0,a.jsx)("li",{children:"\u2022 Impact imm\xe9diat"})]})]})]})]})]})}),(0,a.jsx)("h4",{className:"text-md font-semibold text-gray-700 border-b border-gray-200 pb-2",children:"Historique de mes Dons"}),(0,a.jsx)("div",{className:"grid gap-4",children:L.map((e=>{var s;return(0,a.jsxs)(r.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-white rounded-xl p-6 border",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center mb-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-red-600 rounded-full flex items-center justify-center text-white font-bold text-sm mr-3",children:e.bloodType}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:"font-medium text-gray-900",children:["Don de sang ",e.bloodType]}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Score d'\xe9ligibilit\xe9: ",(null===(s=e.eligibilityTest)||void 0===s?void 0:s.score)||"N/A","/100"]})]})]}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Type:"})," ","direct"===e.donationType?"Don spontan\xe9":"Don de campagne"]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Demande envoy\xe9e:"})," ",e.createdAt.toLocaleDateString()]}),e.scheduledDate&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Don programm\xe9:"})," ",e.scheduledDate.toLocaleDateString()]}),e.notes&&(0,a.jsxs)("p",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Notes:"})," ",e.notes]})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"px-3 py-1 rounded-full text-xs font-medium mb-2 ".concat("completed"===e.status?"bg-green-100 text-green-800":"approved"===e.status?"bg-blue-100 text-blue-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:"completed"===e.status?"Don effectu\xe9":"approved"===e.status?"Programm\xe9":"pending"===e.status?"En attente":"Rejet\xe9"}),"approved"===e.status&&e.scheduledDate&&(0,a.jsxs)("div",{className:"text-xs text-blue-600 font-medium",children:[(0,a.jsx)(l.Z,{size:12,className:"inline mr-1"}),e.scheduledDate.toLocaleDateString()]})]})]}),e.eligibilityTest&&(0,a.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-100",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"\xc2ge:"}),(0,a.jsxs)("span",{className:"ml-1 font-medium",children:[e.eligibilityTest.age," ans"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Poids:"}),(0,a.jsxs)("span",{className:"ml-1 font-medium",children:[e.eligibilityTest.weight," kg"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"\xc9ligible:"}),(0,a.jsx)("span",{className:"ml-1 font-medium ".concat(e.eligibilityTest.eligible?"text-green-600":"text-red-600"),children:e.eligibilityTest.eligible?"Oui":"Non"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500",children:"Score:"}),(0,a.jsxs)("span",{className:"ml-1 font-medium",children:[e.eligibilityTest.score,"/100"]})]})]})})]},e.id)}))}),0===L.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(c.Z,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,a.jsx)("p",{className:"text-gray-500 mb-4",children:"Vous n'avez pas encore fait de don"}),(0,a.jsx)(f.Z,{onClick:()=>S("campaigns"),variant:"primary",children:"Voir les campagnes"})]})]}),"rewards"===D&&(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Mes R\xe9compenses"}),(0,a.jsx)("div",{className:"grid md:grid-cols-3 gap-6",children:[1,2,3].map((e=>(0,a.jsx)("div",{className:"bg-gradient-to-br from-yellow-50 to-orange-50 rounded-xl p-6 border border-yellow-200",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(m.Z,{className:"mx-auto h-12 w-12 text-yellow-600 mb-4"}),(0,a.jsxs)("h4",{className:"font-semibold text-gray-900 mb-2",children:["Badge Donneur #",e]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mb-4",children:["R\xe9compense pour ",3*e," dons de sang"]}),(0,a.jsx)(f.Z,{variant:"outline",size:"sm",children:"R\xe9cup\xe9rer"})]})},e)))})]})]})]})}),H&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl p-6 w-full max-w-lg",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Partager votre exp\xe9rience"}),(0,a.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{await(0,j.ET)((0,j.hJ)(v.db,"testimonials"),{userId:null===s||void 0===s?void 0:s.id,userName:null===s||void 0===s?void 0:s.displayName,userPhoto:null===s||void 0===s?void 0:s.photoURL,content:Q,rating:G,approved:!1,createdAt:new Date}),T.ZP.success("T\xe9moignage soumis pour mod\xe9ration"),_(!1),U(""),K(5)}catch(t){T.ZP.error("Erreur lors de l'envoi du t\xe9moignage")}},className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Note"}),(0,a.jsx)("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map((e=>(0,a.jsx)("button",{type:"button",onClick:()=>K(e),className:"p-1",children:(0,a.jsx)(p.Z,{size:24,className:"".concat(e<=G?"text-yellow-400 fill-current":"text-gray-300")})},e)))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Votre t\xe9moignage"}),(0,a.jsx)("textarea",{value:Q,onChange:e=>U(e.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg h-32 resize-none",placeholder:"Partagez votre exp\xe9rience du don de sang...",required:!0})]}),(0,a.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,a.jsx)(f.Z,{type:"button",variant:"ghost",onClick:()=>_(!1),className:"flex-1",children:"Annuler"}),(0,a.jsx)(f.Z,{type:"submit",variant:"primary",className:"flex-1",children:"Publier"})]})]})]})}),ee&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl p-6 w-full max-w-lg",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Test d'\xc9ligibilit\xe9"}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-red-600 h-2 rounded-full transition-all duration-300",style:{width:"".concat((ie+1)/6*100,"%")}})}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:["Question ",ie+1," sur 6"]})]}),(0,a.jsxs)(r.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"mb-8",children:[0===ie&&(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quel est votre \xe2ge ?"}),(0,a.jsx)("div",{className:"flex justify-center mb-4",children:(0,a.jsx)("input",{type:"number",min:"16",max:"70",value:ne.age,onChange:e=>le({...ne,age:parseInt(e.target.value)||18}),className:"w-32 px-4 py-3 border border-gray-300 rounded-lg text-center text-lg font-medium",placeholder:"18"})}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"L'\xe2ge requis est entre 18 et 65 ans"})]}),1===ie&&(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quel est votre poids ?"}),(0,a.jsxs)("div",{className:"flex justify-center items-center mb-4",children:[(0,a.jsx)("input",{type:"number",min:"40",max:"150",value:ne.weight,onChange:e=>le({...ne,weight:parseInt(e.target.value)||50}),className:"w-32 px-4 py-3 border border-gray-300 rounded-lg text-center text-lg font-medium",placeholder:"50"}),(0,a.jsx)("span",{className:"ml-2 text-gray-600 font-medium",children:"kg"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Le poids minimum requis est de 50 kg"})]}),2===ie&&(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quand avez-vous fait votre dernier don ?"}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("input",{type:"date",value:ne.lastDonation,onChange:e=>le({...ne,lastDonation:e.target.value}),className:"px-4 py-3 border border-gray-300 rounded-lg text-center"})}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Laissez vide si c'est votre premier don"})]}),3===ie&&(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-6",children:"Souffrez-vous actuellement d'une maladie ou infection ?"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)("button",{onClick:()=>le({...ne,hasIllness:!1}),className:"px-8 py-3 rounded-lg font-medium transition-colors ".concat(ne.hasIllness?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-green-600 text-white"),children:"Non"}),(0,a.jsx)("button",{onClick:()=>le({...ne,hasIllness:!0}),className:"px-8 py-3 rounded-lg font-medium transition-colors ".concat(ne.hasIllness?"bg-red-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Oui"})]})]}),4===ie&&(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-6",children:"Prenez-vous actuellement des m\xe9dicaments ?"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)("button",{onClick:()=>le({...ne,takesMedication:!1}),className:"px-8 py-3 rounded-lg font-medium transition-colors ".concat(ne.takesMedication?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-green-600 text-white"),children:"Non"}),(0,a.jsx)("button",{onClick:()=>le({...ne,takesMedication:!0}),className:"px-8 py-3 rounded-lg font-medium transition-colors ".concat(ne.takesMedication?"bg-red-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Oui"})]})]}),5===ie&&(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h4",{className:"text-lg font-medium text-gray-900 mb-6",children:"Avez-vous voyag\xe9 dans une zone \xe0 risque ces 6 derniers mois ?"}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)("button",{onClick:()=>le({...ne,hasTraveled:!1}),className:"px-8 py-3 rounded-lg font-medium transition-colors ".concat(ne.hasTraveled?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-green-600 text-white"),children:"Non"}),(0,a.jsx)("button",{onClick:()=>le({...ne,hasTraveled:!0}),className:"px-8 py-3 rounded-lg font-medium transition-colors ".concat(ne.hasTraveled?"bg-red-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Oui"})]})]})]},ie),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)(f.Z,{variant:"ghost",onClick:()=>{ie>0?re(ie-1):(se(!1),re(0))},className:"flex-1",children:ie>0?"Pr\xe9c\xe9dent":"Annuler"}),(0,a.jsx)(f.Z,{variant:"primary",onClick:()=>{ie<5?re(ie+1):(async()=>{ke().eligible?(T.ZP.success("F\xe9licitations ! Vous \xeates \xe9ligible pour faire un don."),se(!1),te?Ze():ue(!0)):(T.ZP.error("D\xe9sol\xe9, vous n'\xeates pas \xe9ligible pour faire un don actuellement."),se(!1))})()},className:"flex-1",children:ie<5?"Suivant":"V\xe9rifier l'\xe9ligibilit\xe9"})]})]})}),xe&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-white rounded-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"S\xe9lectionner un \xe9tablissement de sant\xe9"}),(0,a.jsx)(A,{onHospitalSelect:e=>me(e),selectedHospital:ce,bloodType:he,className:"mb-6"}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)(f.Z,{variant:"ghost",onClick:()=>{ue(!1),me(null)},className:"flex-1",children:"Retour"}),(0,a.jsx)(f.Z,{variant:"primary",onClick:async()=>{if(ce)try{const e=ke(),t=de.find((e=>e.id===ce)),a={userId:null===s||void 0===s?void 0:s.id,userName:null===s||void 0===s?void 0:s.displayName,userEmail:null===s||void 0===s?void 0:s.email,hospitalId:ce,hospitalName:(null===t||void 0===t?void 0:t.name)||"H\xf4pital",bloodType:"O+",eligibilityTest:{...ne,lastDonation:ne.lastDonation?new Date(ne.lastDonation):null,score:e.score,eligible:e.eligible},status:"pending",donationType:"direct",createdAt:new Date,updatedAt:new Date};await(0,j.ET)((0,j.hJ)(v.db,"donationRequests"),a),T.ZP.success("Candidature de don direct envoy\xe9e ! ".concat((null===t||void 0===t?void 0:t.name)||"L'\xe9tablissement"," vous contactera bient\xf4t.")),ue(!1),me(null),Se()}catch(e){console.error("Erreur lors de l'envoi de la candidature:",e),T.ZP.error("Erreur lors de l'envoi de la candidature")}},disabled:!ce,className:"flex-1 bg-red-600 hover:bg-red-700",children:"\ud83d\udce8 Envoyer la candidature"})]})]})}),(0,a.jsxs)(r.E.button,{initial:{scale:0},animate:{scale:1},whileHover:{scale:1.1},whileTap:{scale:.95},onClick:()=>W(!0),className:"fixed bottom-6 right-6 w-14 h-14 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center z-50 group",children:[(0,a.jsx)(b.Z,{size:24,className:"group-hover:animate-pulse"}),(0,a.jsx)("div",{className:"absolute -top-12 right-0 bg-gray-900 text-white text-xs px-3 py-1 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap",children:"Assistant IA"})]}),X&&(0,a.jsx)(C,{isOpen:X,onClose:()=>W(!1)})]})})}}},function(e){e.O(0,[358,139,341,710,968,390,971,117,744],(function(){return s=8016,e(e.s=s);var s}));var s=e.O();_N_E=s}]);